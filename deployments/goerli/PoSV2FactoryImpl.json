{
  "address": "0x20d9Fe4FbE713500EeE487B828576A8c7A0522B9",
  "abi": [
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "address",
          "name": "pos",
          "type": "address"
        },
        {
          "indexed": false,
          "internalType": "address",
          "name": "ctsiAddress",
          "type": "address"
        },
        {
          "indexed": false,
          "internalType": "address",
          "name": "stakingAddress",
          "type": "address"
        },
        {
          "indexed": false,
          "internalType": "address",
          "name": "workerAuthAddress",
          "type": "address"
        },
        {
          "indexed": false,
          "internalType": "uint64",
          "name": "minDifficulty",
          "type": "uint64"
        },
        {
          "indexed": false,
          "internalType": "uint64",
          "name": "initialDifficulty",
          "type": "uint64"
        },
        {
          "indexed": false,
          "internalType": "uint32",
          "name": "difficultyAdjustmentParameter",
          "type": "uint32"
        },
        {
          "indexed": false,
          "internalType": "uint32",
          "name": "targetInterval",
          "type": "uint32"
        },
        {
          "indexed": false,
          "internalType": "uint256",
          "name": "rewardValue",
          "type": "uint256"
        },
        {
          "indexed": false,
          "internalType": "uint32",
          "name": "rewardDelay",
          "type": "uint32"
        },
        {
          "indexed": false,
          "internalType": "uint32",
          "name": "version",
          "type": "uint32"
        }
      ],
      "name": "NewChain",
      "type": "event"
    },
    {
      "anonymous": false,
      "inputs": [
        {
          "indexed": true,
          "internalType": "address",
          "name": "previousOwner",
          "type": "address"
        },
        {
          "indexed": true,
          "internalType": "address",
          "name": "newOwner",
          "type": "address"
        }
      ],
      "name": "OwnershipTransferred",
      "type": "event"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "_ctsiAddress",
          "type": "address"
        },
        {
          "internalType": "address",
          "name": "_stakingAddress",
          "type": "address"
        },
        {
          "internalType": "address",
          "name": "_workerAuthAddress",
          "type": "address"
        },
        {
          "internalType": "uint64",
          "name": "_minDifficulty",
          "type": "uint64"
        },
        {
          "internalType": "uint64",
          "name": "_initialDifficulty",
          "type": "uint64"
        },
        {
          "internalType": "uint32",
          "name": "_difficultyAdjustmentParameter",
          "type": "uint32"
        },
        {
          "internalType": "uint32",
          "name": "_targetInterval",
          "type": "uint32"
        },
        {
          "internalType": "uint256",
          "name": "_rewardValue",
          "type": "uint256"
        },
        {
          "internalType": "uint32",
          "name": "_rewardDelay",
          "type": "uint32"
        },
        {
          "internalType": "uint32",
          "name": "_version",
          "type": "uint32"
        }
      ],
      "name": "createNewChain",
      "outputs": [
        {
          "internalType": "address",
          "name": "",
          "type": "address"
        }
      ],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "owner",
      "outputs": [
        {
          "internalType": "address",
          "name": "",
          "type": "address"
        }
      ],
      "stateMutability": "view",
      "type": "function"
    },
    {
      "inputs": [],
      "name": "renounceOwnership",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    },
    {
      "inputs": [
        {
          "internalType": "address",
          "name": "newOwner",
          "type": "address"
        }
      ],
      "name": "transferOwnership",
      "outputs": [],
      "stateMutability": "nonpayable",
      "type": "function"
    }
  ],
  "transactionHash": "0x428e402b57da9d90d296d2b1b321e03da37ab0403016ffb09fe466d44d55f31c",
  "receipt": {
    "to": null,
    "from": "0x18930e8a66a1DbE21D00581216789AAB7460Afd0",
    "contractAddress": "0x20d9Fe4FbE713500EeE487B828576A8c7A0522B9",
    "transactionIndex": 40,
    "gasUsed": "2368753",
    "logsBloom": "0x00000000000000000000000000000000000000000000000000800020000000000000000000000000000000000000004000000000000000000000000000000000000001000000000000000000000000000001000000000000000000000000000000000000020000000000000000000800000000000000000000000000000000400000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000020000000000000000000000000000080000000000000000000000000024000000000",
    "blockHash": "0x5191136573363f96088eb8a33115f050356646c2ba585936e2d285ed0d05ba28",
    "transactionHash": "0x428e402b57da9d90d296d2b1b321e03da37ab0403016ffb09fe466d44d55f31c",
    "logs": [
      {
        "transactionIndex": 40,
        "blockNumber": 7425674,
        "transactionHash": "0x428e402b57da9d90d296d2b1b321e03da37ab0403016ffb09fe466d44d55f31c",
        "address": "0x20d9Fe4FbE713500EeE487B828576A8c7A0522B9",
        "topics": [
          "0x8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0",
          "0x0000000000000000000000000000000000000000000000000000000000000000",
          "0x00000000000000000000000018930e8a66a1dbe21d00581216789aab7460afd0"
        ],
        "data": "0x",
        "logIndex": 17,
        "blockHash": "0x5191136573363f96088eb8a33115f050356646c2ba585936e2d285ed0d05ba28"
      }
    ],
    "blockNumber": 7425674,
    "cumulativeGasUsed": "9515057",
    "status": 1,
    "byzantium": true
  },
  "args": [],
  "numDeployments": 1,
  "solcInputHash": "f1974c6906bc5c057a1d6d58e9bdeddb",
  "metadata": "{\"compiler\":{\"version\":\"0.8.14+commit.80d49f37\"},\"language\":\"Solidity\",\"output\":{\"abi\":[{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"pos\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"address\",\"name\":\"ctsiAddress\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"address\",\"name\":\"stakingAddress\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"address\",\"name\":\"workerAuthAddress\",\"type\":\"address\"},{\"indexed\":false,\"internalType\":\"uint64\",\"name\":\"minDifficulty\",\"type\":\"uint64\"},{\"indexed\":false,\"internalType\":\"uint64\",\"name\":\"initialDifficulty\",\"type\":\"uint64\"},{\"indexed\":false,\"internalType\":\"uint32\",\"name\":\"difficultyAdjustmentParameter\",\"type\":\"uint32\"},{\"indexed\":false,\"internalType\":\"uint32\",\"name\":\"targetInterval\",\"type\":\"uint32\"},{\"indexed\":false,\"internalType\":\"uint256\",\"name\":\"rewardValue\",\"type\":\"uint256\"},{\"indexed\":false,\"internalType\":\"uint32\",\"name\":\"rewardDelay\",\"type\":\"uint32\"},{\"indexed\":false,\"internalType\":\"uint32\",\"name\":\"version\",\"type\":\"uint32\"}],\"name\":\"NewChain\",\"type\":\"event\"},{\"anonymous\":false,\"inputs\":[{\"indexed\":true,\"internalType\":\"address\",\"name\":\"previousOwner\",\"type\":\"address\"},{\"indexed\":true,\"internalType\":\"address\",\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"OwnershipTransferred\",\"type\":\"event\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"_ctsiAddress\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_stakingAddress\",\"type\":\"address\"},{\"internalType\":\"address\",\"name\":\"_workerAuthAddress\",\"type\":\"address\"},{\"internalType\":\"uint64\",\"name\":\"_minDifficulty\",\"type\":\"uint64\"},{\"internalType\":\"uint64\",\"name\":\"_initialDifficulty\",\"type\":\"uint64\"},{\"internalType\":\"uint32\",\"name\":\"_difficultyAdjustmentParameter\",\"type\":\"uint32\"},{\"internalType\":\"uint32\",\"name\":\"_targetInterval\",\"type\":\"uint32\"},{\"internalType\":\"uint256\",\"name\":\"_rewardValue\",\"type\":\"uint256\"},{\"internalType\":\"uint32\",\"name\":\"_rewardDelay\",\"type\":\"uint32\"},{\"internalType\":\"uint32\",\"name\":\"_version\",\"type\":\"uint32\"}],\"name\":\"createNewChain\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"owner\",\"outputs\":[{\"internalType\":\"address\",\"name\":\"\",\"type\":\"address\"}],\"stateMutability\":\"view\",\"type\":\"function\"},{\"inputs\":[],\"name\":\"renounceOwnership\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"},{\"inputs\":[{\"internalType\":\"address\",\"name\":\"newOwner\",\"type\":\"address\"}],\"name\":\"transferOwnership\",\"outputs\":[],\"stateMutability\":\"nonpayable\",\"type\":\"function\"}],\"devdoc\":{\"kind\":\"dev\",\"methods\":{\"createNewChain(address,address,address,uint64,uint64,uint32,uint32,uint256,uint32,uint32)\":{\"params\":{\"_ctsiAddress\":\"address of token instance being used\",\"_difficultyAdjustmentParameter\":\"how quickly the difficulty gets updated\",\"_rewardDelay\":\"number of blocks confirmation before a reward can be claimed\",\"_rewardValue\":\"reward that reward manager contract pays\",\"_stakingAddress\":\"address of StakingInterface\",\"_targetInterval\":\"how often we want to elect a block producer\",\"_version\":\"protocol version of PoS\",\"_workerAuthAddress\":\"address of worker manager contract\"}},\"owner()\":{\"details\":\"Returns the address of the current owner.\"},\"renounceOwnership()\":{\"details\":\"Leaves the contract without owner. It will not be possible to call `onlyOwner` functions anymore. Can only be called by the current owner. NOTE: Renouncing ownership will leave the contract without an owner, thereby removing any functionality that is only available to the owner.\"},\"transferOwnership(address)\":{\"details\":\"Transfers ownership of the contract to a new account (`newOwner`). Can only be called by the current owner.\"}},\"version\":1},\"userdoc\":{\"events\":{\"NewChain(address,address,address,address,uint64,uint64,uint32,uint32,uint256,uint32,uint32)\":{\"notice\":\"Event emmited when a new chain is created\"}},\"kind\":\"user\",\"methods\":{},\"version\":1}},\"settings\":{\"compilationTarget\":{\"contracts/v2/PoSV2FactoryImpl.sol\":\"PoSV2FactoryImpl\"},\"evmVersion\":\"london\",\"libraries\":{},\"metadata\":{\"bytecodeHash\":\"ipfs\",\"useLiteralContent\":true},\"optimizer\":{\"enabled\":true,\"runs\":200},\"remappings\":[]},\"sources\":{\"@cartesi/tree/contracts/Tree.sol\":{\"content\":\"// Copyright 2022 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n/// @title Tree Library\\n\\npragma solidity ^0.8.0;\\n\\nlibrary Tree {\\n    // The tree can store up to UINT32_MAX vertices, the type uses uint256 for gas optimization purpose.\\n    // It's the library caller's responsibility to check the input arguments are within the proper range\\n    uint256 constant UINT32_MAX = 2**32 - 1;\\n    // count of trailing ones for [0:256)\\n    // each number takes one byte\\n    bytes constant trailing1table =\\n        hex\\\"00010002000100030001000200010004000100020001000300010002000100050001000200010003000100020001000400010002000100030001000200010006000100020001000300010002000100040001000200010003000100020001000500010002000100030001000200010004000100020001000300010002000100070001000200010003000100020001000400010002000100030001000200010005000100020001000300010002000100040001000200010003000100020001000600010002000100030001000200010004000100020001000300010002000100050001000200010003000100020001000400010002000100030001000200010008\\\";\\n\\n    struct TreeCtx {\\n        uint32 deepestVertex;\\n        uint32 deepestDepth;\\n        uint32 verticesLength;\\n        mapping(uint256 => Vertex) vertices;\\n    }\\n\\n    struct Vertex {\\n        uint32 depth; // depth of the vertex in the tree\\n        uint32 ancestorsLength;\\n        // Each uint256 value stores 8 ancestors, each takes a uint32 slot,\\n        // the key used to access the value should be preprocessed,\\n        // 0 => uint32[7],uint32[6],uint32[5],uint32[4],uint32[3],uint32[2],uint32[1],uint32[0]\\n        // 1 => uint32[15],uint32[14],uint32[13],uint32[12],uint32[11],uint32[10],uint32[9],uint32[8]\\n        // A vertex can have up to 32 ancestors\\n        mapping(uint256 => uint256) ancestors; // pointers to ancestors' indices in the vertices map (tree)\\n    }\\n\\n    event VertexInserted(uint256 _parent);\\n\\n    /// @notice Insert a vertex to the tree\\n    /// @param _tree pointer to the tree storage\\n    /// @param _parent the index of parent vertex in the vertices map (tree)\\n    /// @return index of the inserted vertex\\n    /// @dev the tree can hold up to UINT32_MAX vertices, if the insertVertex is called when tree is full, the transaction will be reverted\\n    function insertVertex(TreeCtx storage _tree, uint256 _parent)\\n        external\\n        returns (uint256)\\n    {\\n        uint256 treeSize = _tree.verticesLength;\\n\\n        _tree.verticesLength++;\\n        Vertex storage v = _tree.vertices[treeSize];\\n\\n        if (treeSize == 0) {\\n            // insert the very first vertex into the tree\\n            // v is initialized with zeros already\\n        } else {\\n            // insert vertex to the tree attaching to another vertex\\n            require(_parent < treeSize, \\\"parent index exceeds tree size\\\");\\n\\n            uint256 parentDepth = _tree.vertices[_parent].depth;\\n\\n            // construct the ancestors map in batch\\n            batchSetAncestors(v, parentDepth);\\n        }\\n\\n        uint256 depth = v.depth;\\n        if (depth > _tree.deepestDepth) {\\n            _tree.deepestDepth = uint32(depth);\\n            _tree.deepestVertex = uint32(treeSize);\\n        }\\n\\n        emit VertexInserted(_parent);\\n\\n        return treeSize;\\n    }\\n\\n    /// @notice Set ancestors in batches, each of which has up to 8 ancestors\\n    /// @param _v pointer to the vertex storage\\n    /// @param _parentDepth the parent depth\\n    function batchSetAncestors(Vertex storage _v, uint256 _parentDepth)\\n        private\\n    {\\n        // calculate all ancestors' depths of the new vertex\\n        uint256[] memory requiredDepths = getRequiredDepths(_parentDepth + 1);\\n        uint256 batchPointer; // point to the beginning of a batch\\n\\n        while (batchPointer < requiredDepths.length) {\\n            uint256 ancestorsBatch; // stores up to 8 ancestors\\n            uint256 offset; // 0~8\\n            while (\\n                offset < 8 && batchPointer + offset < requiredDepths.length\\n            ) {\\n                ancestorsBatch =\\n                    ancestorsBatch |\\n                    (requiredDepths[batchPointer + offset] << (offset * 32));\\n\\n                ++offset;\\n            }\\n            _v.ancestors[batchPointer / 8] = ancestorsBatch;\\n\\n            batchPointer += offset;\\n        }\\n\\n        _v.depth = uint32(_parentDepth + 1);\\n        _v.ancestorsLength = uint32(requiredDepths.length);\\n    }\\n\\n    /// @notice Get an ancestor of a vertex from its ancestor cache by offset\\n    /// @param _tree pointer to the tree storage\\n    /// @param _vertex the index of the vertex in the vertices map (tree)\\n    /// @param _ancestorOffset the offset of the ancestor in ancestor cache\\n    /// @return index of ancestor vertex in the tree\\n    function getAncestor(\\n        TreeCtx storage _tree,\\n        uint256 _vertex,\\n        uint256 _ancestorOffset\\n    ) public view returns (uint256) {\\n        require(\\n            _vertex < _tree.verticesLength,\\n            \\\"vertex index exceeds tree size\\\"\\n        );\\n\\n        Vertex storage v = _tree.vertices[_vertex];\\n\\n        require(_ancestorOffset < v.ancestorsLength, \\\"offset exceeds cache size\\\");\\n\\n        uint256 key = _ancestorOffset / 8;\\n        uint256 offset = _ancestorOffset % 8;\\n        uint256 ancestor = (v.ancestors[key] >> (offset * 32)) & 0xffffffff;\\n\\n        return ancestor;\\n    }\\n\\n    /// @notice Search an ancestor of a vertex in the tree at a certain depth\\n    /// @param _tree pointer to the tree storage\\n    /// @param _vertex the index of the vertex in the vertices map (tree)\\n    /// @param _depth the depth of the ancestor\\n    /// @return index of ancestor at depth of _vertex\\n    function getAncestorAtDepth(\\n        TreeCtx storage _tree,\\n        uint256 _vertex,\\n        uint256 _depth\\n    ) external view returns (uint256) {\\n        require(\\n            _vertex < _tree.verticesLength,\\n            \\\"vertex index exceeds tree size\\\"\\n        );\\n        require(\\n            _depth <= _tree.vertices[_vertex].depth,\\n            \\\"search depth > vertex depth\\\"\\n        );\\n\\n        uint256 vertex = _vertex;\\n\\n        while (_depth != _tree.vertices[vertex].depth) {\\n            Vertex storage v = _tree.vertices[vertex];\\n            uint256 ancestorsLength = v.ancestorsLength;\\n            // start searching from the oldest ancestor (smallest depth)\\n            // example: search ancestor at depth d(20, b'0001 0100) from vertex v at depth (176, b'1011 0000)\\n            //    b'1011 0000 -> b'1010 0000 -> b'1000 0000\\n            // -> b'0100 0000 -> b'0010 0000 -> b'0001 1000\\n            // -> b'0001 0100\\n\\n            // given that ancestorsOffset is unsigned, when -1 at 0, it'll underflow and become UINT32_MAX\\n            // so the continue condition has to be ancestorsOffset < ancestorsLength,\\n            // can't be ancestorsOffset >= 0\\n            uint256 temp_v = vertex;\\n            for (\\n                uint256 ancestorsOffset = ancestorsLength - 1;\\n                ancestorsOffset < ancestorsLength;\\n\\n            ) {\\n                vertex = getAncestor(_tree, temp_v, ancestorsOffset);\\n\\n                // stop at the ancestor who's closest to the target depth\\n                if (_tree.vertices[vertex].depth >= _depth) {\\n                    break;\\n                }\\n\\n                unchecked {\\n                    --ancestorsOffset;\\n                }\\n            }\\n        }\\n\\n        return vertex;\\n    }\\n\\n    /// @notice Get depth of vertex\\n    /// @param _tree pointer to the tree storage\\n    /// @param _vertex the index of the vertex in the vertices map (tree)\\n    function getDepth(TreeCtx storage _tree, uint256 _vertex)\\n        external\\n        view\\n        returns (uint256)\\n    {\\n        return getVertex(_tree, _vertex).depth;\\n    }\\n\\n    /// @notice Get vertex from the tree\\n    /// @param _tree pointer to the tree storage\\n    /// @param _vertex the index of the vertex in the vertices map (tree)\\n    function getVertex(TreeCtx storage _tree, uint256 _vertex)\\n        public\\n        view\\n        returns (Vertex storage)\\n    {\\n        require(\\n            _vertex < _tree.verticesLength,\\n            \\\"vertex index exceeds tree size\\\"\\n        );\\n\\n        return _tree.vertices[_vertex];\\n    }\\n\\n    /// @notice Get current tree size\\n    /// @param _tree pointer to the tree storage\\n    function getTreeSize(TreeCtx storage _tree)\\n        external\\n        view\\n        returns (uint256)\\n    {\\n        return _tree.verticesLength;\\n    }\\n\\n    /// @notice Get current tree size\\n    /// @param _tree pointer to the tree storage\\n    /// @return index number and depth of the deepest vertex\\n    function getDeepest(TreeCtx storage _tree)\\n        external\\n        view\\n        returns (uint256, uint256)\\n    {\\n        return (_tree.deepestVertex, _tree.deepestDepth);\\n    }\\n\\n    function getRequiredDepths(uint256 _depth)\\n        private\\n        pure\\n        returns (uint256[] memory)\\n    {\\n        // parent is always included in the ancestors\\n        uint256 depth = _depth - 1;\\n        uint256 count = 1;\\n\\n        // algorithm 1\\n        // get count of trailing ones of _depth from trailing1table\\n        for (uint256 i = 0; i < 4; ) {\\n            uint256 partialCount = uint8(\\n                trailing1table[(depth >> (i * 8)) & 0xff]\\n            );\\n            count = count + partialCount;\\n            if (partialCount != 8) {\\n                break;\\n            }\\n\\n            unchecked {\\n                ++i;\\n            }\\n        }\\n\\n        // algorithm 2\\n        // get count of trailing ones by counting them\\n        // {\\n        //     while (depth & 1 > 0) {\\n        //         depth = depth >> 1;\\n        //         ++count;\\n        //     }\\n\\n        //     depth = _depth - 1;\\n        // }\\n\\n        uint256[] memory depths = new uint256[](count);\\n\\n        // construct the depths array by removing the trailing ones from lsb one by one\\n        // example _depth = b'1100 0000: b'1011 1111 -> b'1011 1110 -> b'1011 1100\\n        //                            -> b'1011 1000 -> b'1011 0000 -> b'1010 0000\\n        //                            -> b'1000 0000\\n        for (uint256 i = 0; i < count; ) {\\n            depths[i] = depth;\\n            depth = depth & (UINT32_MAX << (i + 1));\\n\\n            unchecked {\\n                ++i;\\n            }\\n        }\\n\\n        return depths;\\n    }\\n}\\n\",\"keccak256\":\"0xf9f21db397a96d1b093e20972e5ec4f3777997b30c0e47ec688d2378465b2be7\",\"license\":\"Apache-2.0\"},\"@cartesi/util/contracts/Bitmask.sol\":{\"content\":\"// Copyright 2021 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\npragma solidity ^0.8.0;\\n\\n/// @title Bit Mask Library\\n/// @author Stephen Chen\\n/// @notice Implements bit mask with dynamic array\\nlibrary Bitmask {\\n    /// @notice Set a bit in the bit mask\\n    function setBit(\\n        mapping(uint256 => uint256) storage bitmask,\\n        uint256 _bit,\\n        bool _value\\n    ) public {\\n        // calculate the number of bits has been store in bitmask now\\n        uint256 positionOfMask = uint256(_bit / 256);\\n        uint256 positionOfBit = _bit % 256;\\n\\n        if (_value) {\\n            bitmask[positionOfMask] =\\n                bitmask[positionOfMask] |\\n                (1 << positionOfBit);\\n        } else {\\n            bitmask[positionOfMask] =\\n                bitmask[positionOfMask] &\\n                ~(1 << positionOfBit);\\n        }\\n    }\\n\\n    /// @notice Get a bit in the bit mask\\n    function getBit(mapping(uint256 => uint256) storage bitmask, uint256 _bit)\\n        public\\n        view\\n        returns (bool)\\n    {\\n        // calculate the number of bits has been store in bitmask now\\n        uint256 positionOfMask = uint256(_bit / 256);\\n        uint256 positionOfBit = _bit % 256;\\n\\n        return ((bitmask[positionOfMask] & (1 << positionOfBit)) != 0);\\n    }\\n}\\n\",\"keccak256\":\"0xe35cf68672f5844589c0e56f36aa3813ca4ffb882a55a46d15adac7e3cc889bd\",\"license\":\"Apache-2.0\"},\"@cartesi/util/contracts/IWorkerAuthManager.sol\":{\"content\":\"// Copyright 2020 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n/// @title WorkerAuthManager\\n/// @author Danilo Tuler\\npragma solidity >=0.7.0;\\n\\ninterface IWorkerAuthManager {\\n    /// @notice Gives worker permission to act on a DApp\\n    /// @param _workerAddress address of the worker node to given permission\\n    /// @param _dappAddress address of the dapp that permission will be given to\\n    function authorize(address _workerAddress, address _dappAddress) external;\\n\\n    /// @notice Removes worker's permission to act on a DApp\\n    /// @param _workerAddress address of the proxy that will lose permission\\n    /// @param _dappAddresses addresses of dapps that will lose permission\\n    function deauthorize(address _workerAddress, address _dappAddresses) external;\\n\\n    /// @notice Returns is the dapp is authorized to be called by that worker\\n    /// @param _workerAddress address of the worker\\n    /// @param _dappAddress address of the DApp\\n    function isAuthorized(address _workerAddress, address _dappAddress) external view returns (bool);\\n\\n    /// @notice Get the owner of the worker node\\n    /// @param workerAddress address of the worker node\\n    function getOwner(address workerAddress) external view returns (address);\\n\\n    /// @notice A DApp has been authorized by a user for a worker\\n    event Authorization(address indexed user, address indexed worker, address indexed dapp);\\n\\n    /// @notice A DApp has been deauthorized by a user for a worker\\n    event Deauthorization(address indexed user, address indexed worker, address indexed dapp);\\n}\\n\",\"keccak256\":\"0x798fd456b0b34cacf5ea8b0979b3bf82a8e0bff4867c45409a0b907cab8f48ab\",\"license\":\"Apache-2.0\"},\"@cartesi/util/contracts/UnrolledCordic.sol\":{\"content\":\"// Copyright 2020 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n///@title UnrolledCordic.sol\\n///@author Gabriel Barros, Diego Nehab\\npragma solidity ^0.8.0;\\n\\nlibrary UnrolledCordic {\\n    uint256 constant one = 0x8000000000000000000000000000000000000000000000000000000000000000;\\n    uint256 constant log2_e = 0xb8aa3b295c17f0bbbe87fed0691d3e88eb577aa8dd695a588b25166cd1a13248;\\n\\n    uint64 constant N = 64;\\n    uint256 constant log2_ks0 = 0xb31fb7d64898b3e15c01a39fbd687a02934f0979a3715fd4ae00d1cfdeb43d0;\\n    uint256 constant log2_ks1 = 0xb84e236bd563ba016fe50b6ef0851802dcf2d0b85a453105aeb4dd63bf61cc;\\n    uint256 constant log2_ks2 = 0xb8a476150dfe4001713d62f7957c3002e24ca6e87e8a8005c3e0ffc29d593;\\n    uint256 constant log2_ks3 = 0xb8a9ded47c110001715305002e4b0002e2a32762fa6c0005c53ac47e94d9;\\n    uint256 constant log2_ks4 = 0xb8aa35640a80000171545f3d72b00002e2a8905062300005c55067f6e59;\\n    uint256 constant log2_ks5 = 0xb8aa3acd07000001715474e164000002e2a8e6e01f000005c551c2359a;\\n\\n    function log2m64(uint256 x) internal pure returns (uint256) {\\n        uint256 y = 0;\\n        uint256 t;\\n\\n        unchecked {\\n            // round(log_2(1+1/2^i)*2^64) for i = 1..4 packed into 64bits each\\n            t = x + (x >> 1);\\n            if (t < one) {\\n                x = t;\\n                y += log2_ks0 << 192;\\n            }\\n            t = x + (x >> 2);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks0 >> 64) << 192;\\n            }\\n            t = x + (x >> 3);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks0 >> 128) << 192;\\n            }\\n            t = x + (x >> 4);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks0 >> 192) << 192;\\n            }\\n            // round(log_2(1+1/2^i)*2^64) for i = 5..8 packed into 64bits each\\n            t = x + (x >> 5);\\n            if (t < one) {\\n                x = t;\\n                y += log2_ks1 << 192;\\n            }\\n            t = x + (x >> 6);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks1 >> 64) << 192;\\n            }\\n            t = x + (x >> 7);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks1 >> 128) << 192;\\n            }\\n            t = x + (x >> 8);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks1 >> 192) << 192;\\n            }\\n            // round(log_2(1+1/2^i)*2^64) for i = 9..12 packed into 64bits each\\n            t = x + (x >> 9);\\n            if (t < one) {\\n                x = t;\\n                y += log2_ks2 << 192;\\n            }\\n            t = x + (x >> 10);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks2 >> 64) << 192;\\n            }\\n            t = x + (x >> 11);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks2 >> 128) << 192;\\n            }\\n            t = x + (x >> 12);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks2 >> 192) << 192;\\n            }\\n            // round(log_2(1+1/2^i)*2^64) for i = 13..16 packed into 64bits each\\n            t = x + (x >> 13);\\n            if (t < one) {\\n                x = t;\\n                y += log2_ks3 << 192;\\n            }\\n            t = x + (x >> 14);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks3 >> 64) << 192;\\n            }\\n            t = x + (x >> 15);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks3 >> 128) << 192;\\n            }\\n            t = x + (x >> 16);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks3 >> 192) << 192;\\n            }\\n            // round(log_2(1+1/2^i)*2^64) for i = 17..20 packed into 64bits each\\n            t = x + (x >> 17);\\n            if (t < one) {\\n                x = t;\\n                y += log2_ks4 << 192;\\n            }\\n            t = x + (x >> 18);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks4 >> 64) << 192;\\n            }\\n            t = x + (x >> 19);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks4 >> 128) << 192;\\n            }\\n            t = x + (x >> 20);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks4 >> 192) << 192;\\n            }\\n            // round(log_2(1+1/2^i)*2^64) for i = 21..24 packed into 64bits each\\n            t = x + (x >> 21);\\n            if (t < one) {\\n                x = t;\\n                y += log2_ks5 << 192;\\n            }\\n            t = x + (x >> 22);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks5 >> 64) << 192;\\n            }\\n            t = x + (x >> 23);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks5 >> 128) << 192;\\n            }\\n            t = x + (x >> 24);\\n            if (t < one) {\\n                x = t;\\n                y += (log2_ks5 >> 192) << 192;\\n            }\\n\\n            uint256 r = one - x;\\n            y += mulhi128(log2_e, mulhi128(r, one + (r >> 1)) << 1) << 1;\\n            return y >> (255 - 64);\\n        }\\n    }\\n\\n    function log2Times1e18(uint256 val) external pure returns (uint256) {\\n        int256 il = ilog2(val);\\n        uint256 skewedRes;\\n        unchecked {\\n            if (il + 1 <= 255) {\\n                skewedRes = (uint256(il + 1) << N) - log2m64(val << (255 - uint256(il + 1)));\\n            } else {\\n                skewedRes = (uint256(il + 1) << N) - log2m64(val >> uint256((il + 1) - 255));\\n            }\\n            return (skewedRes * 1e18) >> N;\\n        }\\n    }\\n\\n    function mulhi128(uint256 a, uint256 b) internal pure returns (uint256) {\\n        unchecked {\\n            return (a >> 128) * (b >> 128);\\n        }\\n    }\\n\\n    function ilog2(uint256 val) internal pure returns (int256) {\\n        require(val > 0, \\\"must be greater than zero\\\");\\n        unchecked {\\n            return 255 - int256(clz(val));\\n        }\\n    }\\n\\n    /// @notice count leading zeros\\n    /// @param _num number you want the clz of\\n    /// @dev this a binary search implementation\\n    function clz(uint256 _num) internal pure returns (uint256) {\\n        if (_num == 0) return 256;\\n        unchecked {\\n            uint256 n = 0;\\n            if (_num & 0xFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFFF00000000000000000000000000000000 == 0) {\\n                n = n + 128;\\n                _num = _num << 128;\\n            }\\n            if (_num & 0xFFFFFFFFFFFFFFFF000000000000000000000000000000000000000000000000 == 0) {\\n                n = n + 64;\\n                _num = _num << 64;\\n            }\\n            if (_num & 0xFFFFFFFF00000000000000000000000000000000000000000000000000000000 == 0) {\\n                n = n + 32;\\n                _num = _num << 32;\\n            }\\n            if (_num & 0xFFFF000000000000000000000000000000000000000000000000000000000000 == 0) {\\n                n = n + 16;\\n                _num = _num << 16;\\n            }\\n            if (_num & 0xFF00000000000000000000000000000000000000000000000000000000000000 == 0) {\\n                n = n + 8;\\n                _num = _num << 8;\\n            }\\n            if (_num & 0xF000000000000000000000000000000000000000000000000000000000000000 == 0) {\\n                n = n + 4;\\n                _num = _num << 4;\\n            }\\n            if (_num & 0xC000000000000000000000000000000000000000000000000000000000000000 == 0) {\\n                n = n + 2;\\n                _num = _num << 2;\\n            }\\n            if (_num & 0x8000000000000000000000000000000000000000000000000000000000000000 == 0) {\\n                n = n + 1;\\n            }\\n\\n            return n;\\n        }\\n    }\\n}\\n\",\"keccak256\":\"0xdf677afbc4b061c8d5ca62ebd23565ae34a4b5a67a9c1d420ca0a5cf533caa60\",\"license\":\"Apache-2.0\"},\"@openzeppelin/contracts-0.8/access/Ownable.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\n\\npragma solidity ^0.8.0;\\n\\nimport \\\"../utils/Context.sol\\\";\\n/**\\n * @dev Contract module which provides a basic access control mechanism, where\\n * there is an account (an owner) that can be granted exclusive access to\\n * specific functions.\\n *\\n * By default, the owner account will be the one that deploys the contract. This\\n * can later be changed with {transferOwnership}.\\n *\\n * This module is used through inheritance. It will make available the modifier\\n * `onlyOwner`, which can be applied to your functions to restrict their use to\\n * the owner.\\n */\\nabstract contract Ownable is Context {\\n    address private _owner;\\n\\n    event OwnershipTransferred(address indexed previousOwner, address indexed newOwner);\\n\\n    /**\\n     * @dev Initializes the contract setting the deployer as the initial owner.\\n     */\\n    constructor () {\\n        address msgSender = _msgSender();\\n        _owner = msgSender;\\n        emit OwnershipTransferred(address(0), msgSender);\\n    }\\n\\n    /**\\n     * @dev Returns the address of the current owner.\\n     */\\n    function owner() public view virtual returns (address) {\\n        return _owner;\\n    }\\n\\n    /**\\n     * @dev Throws if called by any account other than the owner.\\n     */\\n    modifier onlyOwner() {\\n        require(owner() == _msgSender(), \\\"Ownable: caller is not the owner\\\");\\n        _;\\n    }\\n\\n    /**\\n     * @dev Leaves the contract without owner. It will not be possible to call\\n     * `onlyOwner` functions anymore. Can only be called by the current owner.\\n     *\\n     * NOTE: Renouncing ownership will leave the contract without an owner,\\n     * thereby removing any functionality that is only available to the owner.\\n     */\\n    function renounceOwnership() public virtual onlyOwner {\\n        emit OwnershipTransferred(_owner, address(0));\\n        _owner = address(0);\\n    }\\n\\n    /**\\n     * @dev Transfers ownership of the contract to a new account (`newOwner`).\\n     * Can only be called by the current owner.\\n     */\\n    function transferOwnership(address newOwner) public virtual onlyOwner {\\n        require(newOwner != address(0), \\\"Ownable: new owner is the zero address\\\");\\n        emit OwnershipTransferred(_owner, newOwner);\\n        _owner = newOwner;\\n    }\\n}\\n\",\"keccak256\":\"0x1cae4f85f114ff17b90414f5da67365b1d00337abb5bce9bf944eb78a2c0673c\",\"license\":\"MIT\"},\"@openzeppelin/contracts-0.8/token/ERC20/IERC20.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\n\\npragma solidity ^0.8.0;\\n\\n/**\\n * @dev Interface of the ERC20 standard as defined in the EIP.\\n */\\ninterface IERC20 {\\n    /**\\n     * @dev Returns the amount of tokens in existence.\\n     */\\n    function totalSupply() external view returns (uint256);\\n\\n    /**\\n     * @dev Returns the amount of tokens owned by `account`.\\n     */\\n    function balanceOf(address account) external view returns (uint256);\\n\\n    /**\\n     * @dev Moves `amount` tokens from the caller's account to `recipient`.\\n     *\\n     * Returns a boolean value indicating whether the operation succeeded.\\n     *\\n     * Emits a {Transfer} event.\\n     */\\n    function transfer(address recipient, uint256 amount) external returns (bool);\\n\\n    /**\\n     * @dev Returns the remaining number of tokens that `spender` will be\\n     * allowed to spend on behalf of `owner` through {transferFrom}. This is\\n     * zero by default.\\n     *\\n     * This value changes when {approve} or {transferFrom} are called.\\n     */\\n    function allowance(address owner, address spender) external view returns (uint256);\\n\\n    /**\\n     * @dev Sets `amount` as the allowance of `spender` over the caller's tokens.\\n     *\\n     * Returns a boolean value indicating whether the operation succeeded.\\n     *\\n     * IMPORTANT: Beware that changing an allowance with this method brings the risk\\n     * that someone may use both the old and the new allowance by unfortunate\\n     * transaction ordering. One possible solution to mitigate this race\\n     * condition is to first reduce the spender's allowance to 0 and set the\\n     * desired value afterwards:\\n     * https://github.com/ethereum/EIPs/issues/20#issuecomment-263524729\\n     *\\n     * Emits an {Approval} event.\\n     */\\n    function approve(address spender, uint256 amount) external returns (bool);\\n\\n    /**\\n     * @dev Moves `amount` tokens from `sender` to `recipient` using the\\n     * allowance mechanism. `amount` is then deducted from the caller's\\n     * allowance.\\n     *\\n     * Returns a boolean value indicating whether the operation succeeded.\\n     *\\n     * Emits a {Transfer} event.\\n     */\\n    function transferFrom(address sender, address recipient, uint256 amount) external returns (bool);\\n\\n    /**\\n     * @dev Emitted when `value` tokens are moved from one account (`from`) to\\n     * another (`to`).\\n     *\\n     * Note that `value` may be zero.\\n     */\\n    event Transfer(address indexed from, address indexed to, uint256 value);\\n\\n    /**\\n     * @dev Emitted when the allowance of a `spender` for an `owner` is set by\\n     * a call to {approve}. `value` is the new allowance.\\n     */\\n    event Approval(address indexed owner, address indexed spender, uint256 value);\\n}\\n\",\"keccak256\":\"0xf8e8d118a7a8b2e134181f7da655f6266aa3a0f9134b2605747139fcb0c5d835\",\"license\":\"MIT\"},\"@openzeppelin/contracts-0.8/utils/Context.sol\":{\"content\":\"// SPDX-License-Identifier: MIT\\n\\npragma solidity ^0.8.0;\\n\\n/*\\n * @dev Provides information about the current execution context, including the\\n * sender of the transaction and its data. While these are generally available\\n * via msg.sender and msg.data, they should not be accessed in such a direct\\n * manner, since when dealing with meta-transactions the account sending and\\n * paying for execution may not be the actual sender (as far as an application\\n * is concerned).\\n *\\n * This contract is only required for intermediate, library-like contracts.\\n */\\nabstract contract Context {\\n    function _msgSender() internal view virtual returns (address) {\\n        return msg.sender;\\n    }\\n\\n    function _msgData() internal view virtual returns (bytes calldata) {\\n        this; // silence state mutability warning without generating bytecode - see https://github.com/ethereum/solidity/issues/2691\\n        return msg.data;\\n    }\\n}\\n\",\"keccak256\":\"0xf930d2df426bfcfc1f7415be724f04081c96f4fb9ec8d0e3a521c07692dface0\",\"license\":\"MIT\"},\"contracts/IStaking.sol\":{\"content\":\"// Copyright 2021 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n/// @title Interface Staking\\npragma solidity >=0.7.0 <0.9.0;\\n\\ninterface IStaking {\\n    /// @notice Returns total amount of tokens counted as stake\\n    /// @param _userAddress user to retrieve staked balance from\\n    /// @return finalized staked of _userAddress\\n    function getStakedBalance(address _userAddress)\\n        external\\n        view\\n        returns (uint256);\\n\\n    /// @notice Returns the timestamp when next deposit can be finalized\\n    /// @return timestamp of when finalizeStakes() is callable\\n    function getMaturingTimestamp(address _userAddress)\\n        external\\n        view\\n        returns (uint256);\\n\\n    /// @notice Returns the timestamp when next withdraw can be finalized\\n    /// @return timestamp of when finalizeWithdraw() is callable\\n    function getReleasingTimestamp(address _userAddress)\\n        external\\n        view\\n        returns (uint256);\\n\\n    /// @notice Returns the balance waiting/ready to be matured\\n    /// @return amount that will get staked after finalization\\n    function getMaturingBalance(address _userAddress)\\n        external\\n        view\\n        returns (uint256);\\n\\n    /// @notice Returns the balance waiting/ready to be released\\n    /// @return amount that will get withdrew after finalization\\n    function getReleasingBalance(address _userAddress)\\n        external\\n        view\\n        returns (uint256);\\n\\n    /// @notice Deposit CTSI to be staked. The money will turn into staked\\n    ///         balance after timeToStake days\\n    /// @param _amount The amount of tokens that are gonna be deposited.\\n    function stake(uint256 _amount) external;\\n\\n    /// @notice Remove tokens from staked balance. The money can\\n    ///         be released after timeToRelease seconds, if the\\n    ///         function withdraw is called.\\n    /// @param _amount The amount of tokens that are gonna be unstaked.\\n    function unstake(uint256 _amount) external;\\n\\n    /// @notice Transfer tokens to user's wallet.\\n    /// @param _amount The amount of tokens that are gonna be transferred.\\n    function withdraw(uint256 _amount) external;\\n\\n    // events\\n    /// @notice CTSI tokens were deposited, they count as stake after _maturationDate\\n    /// @param user address of msg.sender\\n    /// @param amount amount deposited for staking\\n    /// @param maturationDate date when the stake can be finalized\\n    event Stake(address indexed user, uint256 amount, uint256 maturationDate);\\n\\n    /// @notice Unstake tokens, moving them to releasing structure\\n    /// @param user address of msg.sender\\n    /// @param amount amount of tokens to be released\\n    /// @param maturationDate date when the tokens can be withdrew\\n    event Unstake(address indexed user, uint256 amount, uint256 maturationDate);\\n\\n    /// @notice Withdraw process was finalized\\n    /// @param user address of msg.sender\\n    /// @param amount amount of tokens withdrawn\\n    event Withdraw(address indexed user, uint256 amount);\\n}\\n\",\"keccak256\":\"0xda69ecab096249069100cd857133f717045d19422061ea06d87eca606ac62dd3\",\"license\":\"Apache-2.0\"},\"contracts/v2/Difficulty.sol\":{\"content\":\"// Copyright 2022 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n/// @title Difficulty Library\\n\\npragma solidity ^0.8.0;\\n\\nlibrary Difficulty {\\n    uint32 constant ADJUSTMENT_BASE = 1000000; // 1M\\n\\n    /// @notice Calculates new difficulty parameter\\n    function getNewDifficulty(\\n        uint256 _minDifficulty,\\n        uint256 _difficulty,\\n        uint256 _difficultyAdjustmentParameter,\\n        uint256 _targetInterval,\\n        uint256 _blocksPassed\\n    ) external pure returns (uint256) {\\n        uint256 adjustment = (_difficulty * _difficultyAdjustmentParameter) /\\n            ADJUSTMENT_BASE +\\n            1;\\n\\n        // @dev to save gas on evaluation, instead of returning the _oldDiff when the target\\n        // was exactly matched - we increase the difficulty.\\n        if (_blocksPassed <= _targetInterval) {\\n            return _difficulty + adjustment;\\n        }\\n\\n        uint256 newDiff = _difficulty - adjustment;\\n\\n        return newDiff > _minDifficulty ? newDiff : _minDifficulty;\\n    }\\n}\\n\",\"keccak256\":\"0x4e78543fd9839bba4f3dfda77a92839566ff6060c2d030f2c715eec64482de1a\",\"license\":\"Apache-2.0\"},\"contracts/v2/DifficultyManagerImpl.sol\":{\"content\":\"// Copyright 2022 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n/// @title Block Selector V2 Implementation\\n\\npragma solidity ^0.8.0;\\n\\nimport \\\"./Difficulty.sol\\\";\\nimport \\\"./abstracts/ADifficultyManager.sol\\\";\\n\\ncontract DifficultyManagerImpl is ADifficultyManager {\\n    // lower bound for difficulty\\n    uint64 immutable minDifficulty;\\n    // 4 bytes constants\\n    // how fast the difficulty gets adjusted to reach the desired interval, number * 1000000\\n    uint32 immutable difficultyAdjustmentParameter;\\n    // desired block selection interval in ethereum blocks\\n    uint32 immutable targetInterval;\\n    // difficulty parameter defines how big the interval will be\\n    uint256 difficulty;\\n\\n    constructor(\\n        uint64 _minDifficulty,\\n        uint64 _initialDifficulty,\\n        uint32 _difficultyAdjustmentParameter,\\n        uint32 _targetInterval\\n    ) {\\n        minDifficulty = _minDifficulty;\\n        difficulty = _initialDifficulty;\\n        difficultyAdjustmentParameter = _difficultyAdjustmentParameter;\\n        targetInterval = _targetInterval;\\n    }\\n\\n    /// @notice Adjust difficulty based on new block production\\n    function adjustDifficulty(uint256 _blockPassed) internal override {\\n        difficulty = Difficulty.getNewDifficulty(\\n            minDifficulty,\\n            difficulty,\\n            difficultyAdjustmentParameter,\\n            targetInterval,\\n            _blockPassed\\n        );\\n\\n        emit DifficultyUpdated(difficulty);\\n    }\\n}\\n\",\"keccak256\":\"0x9ba64653564cf49f7be888af8174413a12915e78f7aea6b824ec8ebc97059cae\",\"license\":\"Apache-2.0\"},\"contracts/v2/Eligibility.sol\":{\"content\":\"// Copyright 2022 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n/// @title Block Selector Library\\n\\npragma solidity ^0.8.0;\\n\\nimport \\\"@cartesi/util/contracts/UnrolledCordic.sol\\\";\\n\\nlibrary Eligibility {\\n    uint256 constant C_40 = 40; // 40 blocks\\n    uint256 constant C_256 = 256; // 256 blocks\\n    uint256 constant DIFFICULTY_BASE_MULTIPLIER = 256 * 1e18; //256 M\\n    uint256 constant UINT256_MAX = 2**256 - 1;\\n\\n    /// @notice Check when address is allowed to produce block\\n    /// @param _ethBlockStamp ethereum block number when current selection started\\n    /// @param _difficulty ethereum block number when current selection started\\n    /// @param _user the address that is gonna get checked\\n    /// @param _weight number that will weight the random number, most likely will be the number of staked tokens\\n    function whenCanProduceBlock(\\n        uint256 _difficulty,\\n        uint256 _ethBlockStamp,\\n        address _user,\\n        uint256 _weight\\n    ) external view returns (uint256) {\\n        // cannot produce if block selector goal hasnt been decided yet\\n        // goal is defined the block after selection was reset\\n        // cannot produce if weight is zero\\n        if (getSelectionBlocksPassed(_ethBlockStamp) == 0 || _weight == 0) {\\n            return UINT256_MAX;\\n        }\\n\\n        uint256 multiplier = 0;\\n        // we want overflow and underflow on purpose\\n        unchecked {\\n            multiplier =\\n                DIFFICULTY_BASE_MULTIPLIER -\\n                getLogOfRandom(_user, _ethBlockStamp);\\n        }\\n\\n        uint256 blocksToWait = (_difficulty * multiplier) / (_weight * 1e12);\\n\\n        unchecked {\\n            return blocksToWait + _ethBlockStamp + C_40;\\n        }\\n    }\\n\\n    /// @notice Calculates the log of the random number between the goal and callers address\\n    /// @param _user address to calculate log of random\\n    /// @param _ethBlockStamp main chain block number of last sidechain block\\n    /// @return log of random number between goal and callers address * 1M\\n    function getLogOfRandom(address _user, uint256 _ethBlockStamp)\\n        internal\\n        view\\n        returns (uint256)\\n    {\\n        // seed for goal takes a block in the future (+40) so it is harder to manipulate\\n        bytes32 currentGoal = blockhash(getSeed(_ethBlockStamp + C_40));\\n        bytes32 hashedAddress = keccak256(abi.encodePacked(_user));\\n        uint256 distance = uint256(\\n            keccak256(abi.encodePacked(hashedAddress, currentGoal))\\n        );\\n\\n        return UnrolledCordic.log2Times1e18(distance);\\n    }\\n\\n    function getSeed(uint256 _previousTarget) internal view returns (uint256) {\\n        uint256 diff = block.number - _previousTarget;\\n        uint256 res = diff / C_256;\\n\\n        // if difference is multiple of 256 (256, 512, 1024)\\n        // preserve old target\\n        if (diff % C_256 == 0) {\\n            return _previousTarget + ((res - 1) * C_256);\\n        }\\n\\n        return _previousTarget + (res * C_256);\\n    }\\n\\n    /// @notice Returns the duration in blocks of current selection proccess\\n    /// @param _ethBlockStamp ethereum block number of last sidechain block\\n    /// @return number of ethereum blocks passed since last selection goal was defined\\n    /// @dev blocks passed resets when target resets\\n    function getSelectionBlocksPassed(uint256 _ethBlockStamp)\\n        internal\\n        view\\n        returns (uint256)\\n    {\\n        unchecked {\\n            // new goal block is decided 40 blocks after sidechain block is created\\n            uint256 goalBlock = _ethBlockStamp + C_40;\\n\\n            // target hasnt been set\\n            if (goalBlock >= block.number) return 0;\\n\\n            uint256 blocksPassed = block.number - goalBlock;\\n\\n            // if blocksPassed is multiple of 256, 256 blocks have passed\\n            // this avoids blocksPassed going to zero right before target change\\n            if (blocksPassed % C_256 == 0) return C_256;\\n\\n            return blocksPassed % C_256;\\n        }\\n    }\\n}\\n\",\"keccak256\":\"0x1b5fc81cd179b5d2ecbd68589963470065a8b0fbd64738c9dbb779fdbd94fbad\",\"license\":\"Apache-2.0\"},\"contracts/v2/EligibilityCalImpl.sol\":{\"content\":\"// Copyright 2022 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n/// @title Eligibility Calculator Implementation\\n\\npragma solidity ^0.8.0;\\n\\nimport \\\"./Eligibility.sol\\\";\\nimport \\\"./abstracts/AEligibilityCal.sol\\\";\\n\\ncontract EligibilityCalImpl is AEligibilityCal {\\n    /// @notice Check if address is allowed to produce block\\n    /// @param _user the address that is gonna get checked\\n    /// @param _weight number that will weight the random number, most likely will be the number of staked tokens\\n    function canProduceBlock(\\n        uint256 _difficulty,\\n        uint256 _ethBlockStamp,\\n        address _user,\\n        uint256 _weight\\n    ) internal view override returns (bool) {\\n        return\\n            block.number >=\\n            Eligibility.whenCanProduceBlock(\\n                _difficulty,\\n                _ethBlockStamp,\\n                _user,\\n                _weight\\n            );\\n    }\\n\\n    /// @notice Check when address is allowed to produce block\\n    /// @param _user the address that is gonna get checked\\n    /// @param _weight number that will weight the random number, most likely will be the number of staked tokens\\n    function whenCanProduceBlock(\\n        uint256 _difficulty,\\n        uint256 _ethBlockStamp,\\n        address _user,\\n        uint256 _weight\\n    ) internal view override returns (uint256) {\\n        return\\n            Eligibility.whenCanProduceBlock(\\n                _difficulty,\\n                _ethBlockStamp,\\n                _user,\\n                _weight\\n            );\\n    }\\n\\n    function getSelectionBlocksPassed(uint256 _ethBlockStamp)\\n        internal\\n        view\\n        override\\n        returns (uint256)\\n    {\\n        return Eligibility.getSelectionBlocksPassed(_ethBlockStamp);\\n    }\\n}\\n\",\"keccak256\":\"0xbfa050e1049470854dbdcf77529193bcd7960b6c99a13c30ce8bab000c58579d\",\"license\":\"Apache-2.0\"},\"contracts/v2/HistoricalDataImpl.sol\":{\"content\":\"// Copyright 2022 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n/// @title HistoricalData\\n\\npragma solidity ^0.8.0;\\n\\nimport \\\"@cartesi/tree/contracts/Tree.sol\\\";\\nimport \\\"./abstracts/AHistoricalData.sol\\\";\\n\\ncontract HistoricalDataImpl is AHistoricalData {\\n    using Tree for Tree.TreeCtx;\\n\\n    struct LatestCtx {\\n        address lastProducer;\\n        uint32 ethBlockStamp;\\n        uint32 sidechainBlockCount;\\n    }\\n\\n    struct HistoricalCtx {\\n        Tree.TreeCtx tree;\\n        LatestCtx latestCtx;\\n        mapping(uint256 => BlockData) blockData;\\n    }\\n\\n    HistoricalCtx historicalCtx;\\n\\n    /// @notice Get mainchain block number of last sidechain block\\n    function getEthBlockStamp() external view override returns (uint256) {\\n        return historicalCtx.latestCtx.ethBlockStamp;\\n    }\\n\\n    /// @notice Get the producer of last sidechain block\\n    function getLastProducer() external view override returns (address) {\\n        return historicalCtx.latestCtx.lastProducer;\\n    }\\n\\n    /// @notice Get sidechain block count\\n    function getSidechainBlockCount() external view override returns (uint256) {\\n        return historicalCtx.latestCtx.sidechainBlockCount;\\n    }\\n\\n    /// @notice Get a V2 sidechain block\\n    function getSidechainBlock(uint256 _number)\\n        external\\n        view\\n        override\\n        returns (BlockData memory)\\n    {\\n        return historicalCtx.blockData[_number];\\n    }\\n\\n    /// @notice Validate a V2 sidechain block\\n    /// @param _sidechainBlockNumber the sidechain block number to validate\\n    /// @param _depthDiff the minimal depth diff to validate sidechain block\\n    /// @return bool is the sidechain block valid\\n    /// @return address the producer of the sidechain block\\n    function isValidBlock(uint32 _sidechainBlockNumber, uint32 _depthDiff)\\n        external\\n        view\\n        override\\n        returns (bool, address)\\n    {\\n        uint256 blockDepth = historicalCtx.tree.getDepth(_sidechainBlockNumber);\\n        (uint256 deepestBlock, uint256 deepestDepth) = historicalCtx\\n            .tree\\n            .getDeepest();\\n\\n        if (\\n            historicalCtx.tree.getAncestorAtDepth(deepestBlock, blockDepth) !=\\n            _sidechainBlockNumber\\n        ) {\\n            return (false, address(0));\\n        } else if (deepestDepth - blockDepth >= _depthDiff) {\\n            return (\\n                true,\\n                historicalCtx.blockData[_sidechainBlockNumber].producer\\n            );\\n        } else {\\n            return (false, address(0));\\n        }\\n    }\\n\\n    /// @notice Record block data produced from PoS contract\\n    /// @param _parent the parent block that current block appends to\\n    /// @param _producer the producer of the sidechain block\\n    /// @param _dataHash hash of the data held by the block\\n    function recordBlock(\\n        uint256 _parent,\\n        address _producer,\\n        bytes32 _dataHash\\n    ) internal override returns (uint256) {\\n        uint256 sidechainBlockNumber = historicalCtx.tree.insertVertex(_parent);\\n\\n        historicalCtx.blockData[sidechainBlockNumber] = BlockData(\\n            _producer,\\n            uint32(block.number),\\n            _dataHash\\n        );\\n\\n        updateLatest(_producer, sidechainBlockNumber + 1);\\n\\n        return sidechainBlockNumber;\\n    }\\n\\n    /// @notice Record information about the latest sidechain block\\n    /// @param _producer the producer of the sidechain block\\n    /// @param _sidechainBlockCount count of total sidechain blocks\\n    function updateLatest(address _producer, uint256 _sidechainBlockCount)\\n        internal\\n        virtual\\n        override\\n    {\\n        historicalCtx.latestCtx = LatestCtx(\\n            _producer,\\n            uint32(block.number),\\n            uint32(_sidechainBlockCount)\\n        );\\n    }\\n}\\n\",\"keccak256\":\"0xb933eb4ec09ce0bbb07d17e2310576e95cc756f819c3504ddc826bc79a628d5d\",\"license\":\"Apache-2.0\"},\"contracts/v2/IHistoricalData.sol\":{\"content\":\"// Copyright 2022 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n/// @title Interface HistoricalData\\n\\npragma solidity >=0.8.0;\\n\\ninterface IHistoricalData {\\n    struct BlockData {\\n        address producer;\\n        uint32 mainchainBlockNumber;\\n        bytes32 dataHash;\\n    }\\n\\n    /// @notice Validate a V2 sidechain block\\n    /// @param _sidechainBlockNumber the sidechain block number to validate\\n    /// @param _depthDiff the minimal depth diff to validate sidechain block\\n    /// @return bool is the sidechain block valid\\n    /// @return address the producer of the sidechain block\\n    function isValidBlock(uint32 _sidechainBlockNumber, uint32 _depthDiff)\\n        external\\n        view\\n        returns (bool, address);\\n\\n    /// @notice Get mainchain block number of last sidechain block\\n    function getEthBlockStamp() external view returns (uint256);\\n\\n    /// @notice Get the producer of last sidechain block\\n    function getLastProducer() external view returns (address);\\n\\n    /// @notice Get sidechain block count\\n    function getSidechainBlockCount() external view returns (uint256);\\n\\n    /// @notice Get a V2 sidechain block\\n    function getSidechainBlock(uint256)\\n        external\\n        view\\n        returns (BlockData memory);\\n}\\n\",\"keccak256\":\"0x3dd0cf3935c8e4abc1ba416c6b5ab766333353474668721045093828300ad1a8\",\"license\":\"Apache-2.0\"},\"contracts/v2/IPoSV2.sol\":{\"content\":\"// Copyright 2022 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n/// @title Interface PoSV2\\n\\npragma solidity >=0.8.0;\\n\\ninterface IPoSV2 {\\n    event BlockProduced(\\n        address indexed user,\\n        address indexed worker,\\n        uint32 sidechainBlockNumber,\\n        bytes data\\n    );\\n\\n    /// @notice Produce a block in V2 chains\\n    /// @param _parent the parent block that current block appends to\\n    /// @param _data the data to store in the block\\n    /// @dev this function can only be called by a worker, user never calls it directly\\n    function produceBlock(uint32 _parent, bytes calldata _data)\\n        external\\n        returns (bool);\\n\\n    /// @notice Check if address is allowed to produce block\\n    function canProduceBlock(address _user) external view returns (bool);\\n\\n    /// @notice Get when _user is allowed to produce a sidechain block\\n    /// @return uint256 mainchain block number when the user can produce a sidechain block\\n    function whenCanProduceBlock(address _user) external view returns (uint256);\\n\\n    function terminate() external;\\n}\\n\",\"keccak256\":\"0x4e6b047148b89f65f6812b65296b24c1d94c040bbfcd7c4b4bd019fcd1351f0c\",\"license\":\"Apache-2.0\"},\"contracts/v2/IRewardManagerV2.sol\":{\"content\":\"// Copyright 2022 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n/// @title Interface RewardManagerV2\\n\\npragma solidity >=0.8.0;\\n\\ninterface IRewardManagerV2 {\\n    event Rewarded(uint32 indexed sidechainBlockNumber, uint256 reward);\\n\\n    /// @notice Rewards sidechain blocks for V2 chains\\n    /// @param _sidechainBlockNumbers array of sidechain block numbers\\n    function reward(uint32[] calldata _sidechainBlockNumbers) external;\\n\\n    /// @notice Check if a sidechain block reward is claimed\\n    function isRewarded(uint32 _sidechainBlockNumber)\\n        external\\n        view\\n        returns (bool);\\n\\n    /// @notice Get RewardManager's balance\\n    function getBalance() external view returns (uint256);\\n\\n    /// @notice Get current reward amount\\n    function getCurrentReward() external view returns (uint256);\\n}\\n\",\"keccak256\":\"0x36a0fc092753b605036be5a1da8780ea516ecb6003b9cb201611a3f0cbaeb1d7\",\"license\":\"Apache-2.0\"},\"contracts/v2/PoSV2Factory.sol\":{\"content\":\"// Copyright 2022 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\npragma solidity >=0.8.0;\\n\\ninterface PoSV2Factory {\\n    /// @notice Creates a new chain pos contract\\n    /// emits NewChain with the parameters of the new chain\\n    /// @return new chain address\\n    function createNewChain(\\n        address _ctsiAddress,\\n        address _stakingAddress,\\n        address _workerAuthAddress,\\n        uint64 _minDifficulty,\\n        uint64 _initialDifficulty,\\n        uint32 _difficultyAdjustmentParameter,\\n        uint32 _targetInterval,\\n        uint256 _rewardValue,\\n        uint32 _rewardDelay,\\n        uint32 _version\\n    ) external returns (address);\\n\\n    /// @notice Event emmited when a new chain is created\\n    /// @param pos address of the new chain\\n    event NewChain(\\n        address indexed pos,\\n        address ctsiAddress,\\n        address stakingAddress,\\n        address workerAuthAddress,\\n        uint64 minDifficulty,\\n        uint64 initialDifficulty,\\n        uint32 difficultyAdjustmentParameter,\\n        uint32 targetInterval,\\n        uint256 rewardValue,\\n        uint32 rewardDelay,\\n        uint32 version\\n    );\\n}\\n\",\"keccak256\":\"0xb914bde8e915fd5064c94c7b876991f82064bf1bc07f4af03d292fbfbff81109\",\"license\":\"Apache-2.0\"},\"contracts/v2/PoSV2FactoryImpl.sol\":{\"content\":\"// Copyright 2022 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n/// @title PoS V2 Factory\\n/// @author Stephen Chen\\n\\npragma solidity ^0.8.0;\\n\\nimport \\\"@openzeppelin/contracts-0.8/access/Ownable.sol\\\";\\n\\nimport \\\"./PoSV2Factory.sol\\\";\\nimport \\\"./PoSV2Impl.sol\\\";\\n\\ncontract PoSV2FactoryImpl is Ownable, PoSV2Factory {\\n    /// @param _ctsiAddress address of token instance being used\\n    /// @param _stakingAddress address of StakingInterface\\n    /// @param _workerAuthAddress address of worker manager contract\\n    /// @param _difficultyAdjustmentParameter how quickly the difficulty gets updated\\n    /// @param _targetInterval how often we want to elect a block producer\\n    /// @param _rewardValue reward that reward manager contract pays\\n    /// @param _rewardDelay number of blocks confirmation before a reward can be claimed\\n    /// @param _version protocol version of PoS\\n    function createNewChain(\\n        address _ctsiAddress,\\n        address _stakingAddress,\\n        address _workerAuthAddress,\\n        // DifficultyManager constructor parameters\\n        uint64 _minDifficulty,\\n        uint64 _initialDifficulty,\\n        uint32 _difficultyAdjustmentParameter,\\n        uint32 _targetInterval,\\n        // RewardManager constructor parameters\\n        uint256 _rewardValue,\\n        uint32 _rewardDelay,\\n        uint32 _version\\n    ) external override onlyOwner returns (address) {\\n        PoSV2Impl pos = new PoSV2Impl(\\n            _ctsiAddress,\\n            _stakingAddress,\\n            _workerAuthAddress,\\n            _minDifficulty,\\n            _initialDifficulty,\\n            _difficultyAdjustmentParameter,\\n            _targetInterval,\\n            _rewardValue,\\n            _rewardDelay,\\n            _version\\n        );\\n\\n        pos.transferOwnership(msg.sender);\\n\\n        emit NewChain(\\n            address(pos),\\n            _ctsiAddress,\\n            _stakingAddress,\\n            _workerAuthAddress,\\n            _minDifficulty,\\n            _initialDifficulty,\\n            _difficultyAdjustmentParameter,\\n            _targetInterval,\\n            _rewardValue,\\n            _rewardDelay,\\n            _version\\n        );\\n\\n        return address(pos);\\n    }\\n}\\n\",\"keccak256\":\"0x47aa013280029805ed581b836ed584be8054b0abf83d75531e3ef8004c5aac14\",\"license\":\"Apache-2.0\"},\"contracts/v2/PoSV2Impl.sol\":{\"content\":\"// Copyright 2022 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n/// @title Proof of Stake V2\\n/// @author Stephen Chen\\n\\npragma solidity ^0.8.0;\\n\\nimport \\\"@openzeppelin/contracts-0.8/access/Ownable.sol\\\";\\nimport \\\"@cartesi/util/contracts/IWorkerAuthManager.sol\\\";\\n\\nimport \\\"./IPoSV2.sol\\\";\\nimport \\\"./DifficultyManagerImpl.sol\\\";\\nimport \\\"./EligibilityCalImpl.sol\\\";\\nimport \\\"./HistoricalDataImpl.sol\\\";\\nimport \\\"./RewardManagerV2Impl.sol\\\";\\nimport \\\"../IStaking.sol\\\";\\n\\ncontract PoSV2Impl is\\n    IPoSV2,\\n    Ownable,\\n    DifficultyManagerImpl,\\n    EligibilityCalImpl,\\n    HistoricalDataImpl\\n{\\n    uint32 public immutable version;\\n    IStaking public immutable staking;\\n    RewardManagerV2Impl public immutable rewardManager;\\n    IWorkerAuthManager public immutable workerAuth;\\n    address public immutable factory;\\n\\n    bool public active;\\n\\n    /// @param _ctsiAddress address of token instance being used\\n    /// @param _stakingAddress address of StakingInterface\\n    /// @param _workerAuthAddress address of worker manager contract\\n    /// @param _difficultyAdjustmentParameter how quickly the difficulty gets updated\\n    /// @param _targetInterval how often we want to elect a block producer\\n    /// @param _rewardValue reward that reward manager contract pays\\n    /// @param _rewardDelay number of blocks confirmation before a reward can be claimed\\n    /// @param _version protocol version of PoS\\n    constructor(\\n        address _ctsiAddress,\\n        address _stakingAddress,\\n        address _workerAuthAddress,\\n        // DifficultyManager constructor parameters\\n        uint64 _minDifficulty,\\n        uint64 _initialDifficulty,\\n        uint32 _difficultyAdjustmentParameter,\\n        uint32 _targetInterval,\\n        // RewardManager constructor parameters\\n        uint256 _rewardValue,\\n        uint32 _rewardDelay,\\n        uint32 _version\\n    )\\n        DifficultyManagerImpl(\\n            _minDifficulty,\\n            _initialDifficulty,\\n            _difficultyAdjustmentParameter,\\n            _targetInterval\\n        )\\n    {\\n        factory = msg.sender;\\n        version = _version;\\n        staking = IStaking(_stakingAddress);\\n        workerAuth = IWorkerAuthManager(_workerAuthAddress);\\n\\n        rewardManager = new RewardManagerV2Impl(\\n            _ctsiAddress,\\n            address(this),\\n            _rewardValue,\\n            _rewardDelay\\n        );\\n\\n        active = true;\\n        historicalCtx.latestCtx.ethBlockStamp = uint32(block.number);\\n    }\\n\\n    // legacy methods from V1 chains for staking pool V1 compatibility\\n    /// @notice Produce a block in V1 chains\\n    /// @dev this function can only be called by a worker, user never calls it directly\\n    function produceBlock(uint256) external returns (bool) {\\n        require(version == 1, \\\"protocol has to be V1\\\");\\n\\n        address user = _produceBlock();\\n\\n        uint32 sidechainBlockNumber = historicalCtx\\n            .latestCtx\\n            .sidechainBlockCount;\\n\\n        emit BlockProduced(user, msg.sender, sidechainBlockNumber, \\\"\\\");\\n\\n        rewardManager.reward(sidechainBlockNumber, msg.sender);\\n        HistoricalDataImpl.updateLatest(user, sidechainBlockNumber + 1);\\n\\n        return true;\\n    }\\n\\n    /// @notice Produce a block in V2 chains\\n    /// @param _parent the parent block that current block appends to\\n    /// @param _data the data to store in the block\\n    /// @dev this function can only be called by a worker, user never calls it directly\\n    function produceBlock(uint32 _parent, bytes calldata _data)\\n        external\\n        override\\n        returns (bool)\\n    {\\n        require(version == 2, \\\"protocol has to be V2\\\");\\n\\n        address user = _produceBlock();\\n\\n        emit BlockProduced(\\n            user,\\n            msg.sender,\\n            uint32(\\n                HistoricalDataImpl.recordBlock(\\n                    _parent,\\n                    user,\\n                    keccak256(abi.encodePacked(_data))\\n                )\\n            ),\\n            _data\\n        );\\n\\n        return true;\\n    }\\n\\n    /// @notice Check if address is allowed to produce block\\n    function canProduceBlock(address _user)\\n        external\\n        view\\n        override\\n        returns (bool)\\n    {\\n        return\\n            EligibilityCalImpl.canProduceBlock(\\n                difficulty,\\n                historicalCtx.latestCtx.ethBlockStamp,\\n                _user,\\n                staking.getStakedBalance(_user)\\n            );\\n    }\\n\\n    /// @notice Get when _user is allowed to produce a sidechain block\\n    /// @return uint256 mainchain block number when the user can produce a sidechain block\\n    function whenCanProduceBlock(address _user)\\n        external\\n        view\\n        override\\n        returns (uint256)\\n    {\\n        return\\n            EligibilityCalImpl.whenCanProduceBlock(\\n                difficulty,\\n                historicalCtx.latestCtx.ethBlockStamp,\\n                _user,\\n                staking.getStakedBalance(_user)\\n            );\\n    }\\n\\n    function getSelectionBlocksPassed() external view returns (uint256) {\\n        return\\n            EligibilityCalImpl.getSelectionBlocksPassed(\\n                historicalCtx.latestCtx.ethBlockStamp\\n            );\\n    }\\n\\n    // legacy methods from V1 chains for staking pool V1 compatibility\\n    /// @notice Get reward manager address\\n    /// @return address of instance's RewardManager\\n    function getRewardManagerAddress(uint256) external view returns (address) {\\n        return address(rewardManager);\\n    }\\n\\n    function terminate() public override onlyOwner {\\n        require(\\n            rewardManager.getCurrentReward() == 0,\\n            \\\"RewardManager still holds funds\\\"\\n        );\\n\\n        active = false;\\n    }\\n\\n    function _produceBlock() internal returns (address) {\\n        require(\\n            workerAuth.isAuthorized(msg.sender, factory),\\n            \\\"msg.sender is not authorized\\\"\\n        );\\n\\n        address user = workerAuth.getOwner(msg.sender);\\n        uint32 ethBlockStamp = historicalCtx.latestCtx.ethBlockStamp;\\n\\n        require(\\n            EligibilityCalImpl.canProduceBlock(\\n                difficulty,\\n                ethBlockStamp,\\n                user,\\n                staking.getStakedBalance(user)\\n            ),\\n            \\\"User couldnt produce a block\\\"\\n        );\\n\\n        // difficulty\\n        DifficultyManagerImpl.adjustDifficulty(block.number - ethBlockStamp);\\n\\n        return user;\\n    }\\n}\\n\",\"keccak256\":\"0xadd241c758c97b8b9ff1f07c1c5f3bb0a20e67d50127748dc3025863fe8e0653\",\"license\":\"Apache-2.0\"},\"contracts/v2/RewardManagerV2Impl.sol\":{\"content\":\"// Copyright 2020 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n/// @title RewardManager V2\\n/// @author Stephen Chen\\n\\npragma solidity ^0.8.0;\\n\\nimport \\\"@cartesi/util/contracts/Bitmask.sol\\\";\\nimport \\\"@openzeppelin/contracts-0.8/token/ERC20/IERC20.sol\\\";\\n\\nimport \\\"./IHistoricalData.sol\\\";\\nimport \\\"./IRewardManagerV2.sol\\\";\\n\\ncontract RewardManagerV2Impl is IRewardManagerV2 {\\n    using Bitmask for mapping(uint256 => uint256);\\n\\n    mapping(uint256 => uint256) internal rewarded;\\n    uint256 immutable rewardValue;\\n    uint32 immutable rewardDelay;\\n    IERC20 immutable ctsi;\\n    address public immutable pos;\\n\\n    /// @notice Creates contract\\n    /// @param _ctsiAddress address of token instance being used\\n    /// @param _posAddress address of the sidechain\\n    /// @param _rewardValue reward that this contract pays\\n    /// @param _rewardDelay number of blocks confirmation before a reward can be claimed\\n    constructor(\\n        address _ctsiAddress,\\n        address _posAddress,\\n        uint256 _rewardValue,\\n        uint32 _rewardDelay\\n    ) {\\n        ctsi = IERC20(_ctsiAddress);\\n        pos = _posAddress;\\n\\n        rewardValue = _rewardValue;\\n        rewardDelay = _rewardDelay;\\n    }\\n\\n    /// @notice Rewards sidechain block for V1 chains\\n    /// @param _sidechainBlockNumber sidechain block number\\n    /// @param _address address to be rewarded\\n    function reward(uint32 _sidechainBlockNumber, address _address) external {\\n        require(msg.sender == pos, \\\"Only the pos contract can call\\\");\\n\\n        uint256 cReward = currentReward();\\n        ctsi.transfer(_address, cReward);\\n\\n        emit Rewarded(_sidechainBlockNumber, cReward);\\n    }\\n\\n    /// @notice Rewards sidechain blocks for V2 chains\\n    /// @param _sidechainBlockNumbers array of sidechain block numbers\\n    function reward(uint32[] calldata _sidechainBlockNumbers)\\n        external\\n        override\\n    {\\n        for (uint256 i; i < _sidechainBlockNumbers.length; ) {\\n            require(\\n                !rewarded.getBit(_sidechainBlockNumbers[i]),\\n                \\\"The block has been rewarded\\\"\\n            );\\n\\n            (bool isValid, address producer) = IHistoricalData(pos)\\n                .isValidBlock(_sidechainBlockNumbers[i], rewardDelay);\\n\\n            require(isValid, \\\"Invalid block\\\");\\n\\n            uint256 cReward = currentReward();\\n\\n            require(cReward > 0, \\\"RewardManager has no funds\\\");\\n\\n            ctsi.transfer(producer, cReward);\\n            setRewarded(_sidechainBlockNumbers[i]);\\n\\n            emit Rewarded(_sidechainBlockNumbers[i], cReward);\\n\\n            unchecked {\\n                ++i;\\n            }\\n        }\\n    }\\n\\n    /// @notice Get RewardManager's balance\\n    function getBalance() external view override returns (uint256) {\\n        return balance();\\n    }\\n\\n    /// @notice Get current reward amount\\n    function getCurrentReward() external view override returns (uint256) {\\n        return currentReward();\\n    }\\n\\n    /// @notice Check if a sidechain block reward is claimed\\n    function isRewarded(uint32 _sidechainBlockNumber)\\n        external\\n        view\\n        override\\n        returns (bool)\\n    {\\n        return rewarded.getBit(_sidechainBlockNumber);\\n    }\\n\\n    function setRewarded(uint32 _sidechainBlockNumber) private {\\n        rewarded.setBit(_sidechainBlockNumber, true);\\n    }\\n\\n    function balance() private view returns (uint256) {\\n        return ctsi.balanceOf(address(this));\\n    }\\n\\n    function currentReward() private view returns (uint256) {\\n        return rewardValue > balance() ? balance() : rewardValue;\\n    }\\n}\\n\",\"keccak256\":\"0x076dee2bddb5039b619c1a2f838fbecc11ff8a84cc592f661f1f12e8b82a4f35\",\"license\":\"Apache-2.0\"},\"contracts/v2/abstracts/ADifficultyManager.sol\":{\"content\":\"// Copyright 2022 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n/// @title Abstract Difficulty Manager\\n\\npragma solidity ^0.8.0;\\n\\nabstract contract ADifficultyManager {\\n    event DifficultyUpdated(uint256 difficulty);\\n\\n    /// @notice Adjust difficulty based on new block production\\n    function adjustDifficulty(uint256 _blockPassed) internal virtual;\\n}\\n\",\"keccak256\":\"0x987666b37e0b1ed54731f96db1ce340fa892bbb914a650251e76b8501bb346be\",\"license\":\"Apache-2.0\"},\"contracts/v2/abstracts/AEligibilityCal.sol\":{\"content\":\"// Copyright 2022 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n/// @title Abstract Eligibility Calculator\\n\\npragma solidity ^0.8.0;\\n\\nabstract contract AEligibilityCal {\\n    /// @notice Check if _user is allowed to produce a sidechain block\\n    /// @param _ethBlockStamp ethereum block number when current selection started\\n    /// @param _difficulty ethereum block number when current selection started\\n    /// @param _user the address that is gonna get checked\\n    /// @param _weight number that will weight the random number, most likely will be the number of staked tokens\\n    function canProduceBlock(\\n        uint256 _difficulty,\\n        uint256 _ethBlockStamp,\\n        address _user,\\n        uint256 _weight\\n    ) internal view virtual returns (bool);\\n\\n    /// @notice Get when _user is allowed to produce a sidechain block\\n    /// @param _ethBlockStamp ethereum block number when current selection started\\n    /// @param _difficulty ethereum block number when current selection started\\n    /// @param _user the address that is gonna get checked\\n    /// @param _weight number that will weight the random number, most likely will be the number of staked tokens\\n    /// @return uint256 mainchain block number when the user can produce a sidechain block\\n    function whenCanProduceBlock(\\n        uint256 _difficulty,\\n        uint256 _ethBlockStamp,\\n        address _user,\\n        uint256 _weight\\n    ) internal view virtual returns (uint256);\\n\\n    /// @notice Returns the duration in blocks of current selection proccess\\n    /// @param _ethBlockStamp ethereum block number of last sidechain block\\n    /// @return number of ethereum blocks passed since last selection goal was defined\\n    function getSelectionBlocksPassed(uint256 _ethBlockStamp)\\n        internal\\n        view\\n        virtual\\n        returns (uint256);\\n}\\n\",\"keccak256\":\"0xdf6785c2e443f08f8bba3f8eafe621e26896769959b0bed713690995f58414bb\",\"license\":\"Apache-2.0\"},\"contracts/v2/abstracts/AHistoricalData.sol\":{\"content\":\"// Copyright 2022 Cartesi Pte. Ltd.\\n\\n// SPDX-License-Identifier: Apache-2.0\\n// Licensed under the Apache License, Version 2.0 (the \\\"License\\\"); you may not use\\n// this file except in compliance with the License. You may obtain a copy of the\\n// License at http://www.apache.org/licenses/LICENSE-2.0\\n\\n// Unless required by applicable law or agreed to in writing, software distributed\\n// under the License is distributed on an \\\"AS IS\\\" BASIS, WITHOUT WARRANTIES OR\\n// CONDITIONS OF ANY KIND, either express or implied. See the License for the\\n// specific language governing permissions and limitations under the License.\\n\\n/// @title Abstract HistoricalData\\n\\npragma solidity ^0.8.0;\\n\\nimport \\\"../IHistoricalData.sol\\\";\\n\\nabstract contract AHistoricalData is IHistoricalData {\\n    event VertexInserted(uint256 _parent);\\n\\n    /// @notice Record block data produced from PoS contract\\n    /// @param _parent the parent block that current block appends to\\n    /// @param _producer the producer of the sidechain block\\n    /// @param _dataHash hash of the data held by the block\\n    function recordBlock(\\n        uint256 _parent,\\n        address _producer,\\n        bytes32 _dataHash\\n    ) internal virtual returns (uint256);\\n\\n    /// @notice Record information about the latest sidechain block\\n    /// @param _producer the producer of the sidechain block\\n    /// @param _sidechainBlockCount count of total sidechain blocks\\n    function updateLatest(\\n        address _producer,\\n        uint256 _sidechainBlockCount\\n    ) internal virtual;\\n}\\n\",\"keccak256\":\"0xf664e957eb70e16c9505a0eda0cfd26c3e0d3191ae8eecc4b166c3a1877a6ebd\",\"license\":\"Apache-2.0\"}},\"version\":1}",
  "bytecode": "0x608060405234801561001057600080fd5b50600080546001600160a01b031916339081178255604051909182917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0908290a3506129a7806100616000396000f3fe608060405234801561001057600080fd5b506004361061004c5760003560e01c8063715018a6146100515780637d982ea61461005b5780638da5cb5b1461008a578063f2fde38b1461009b575b600080fd5b6100596100ae565b005b61006e61006936600461039b565b61012b565b6040516001600160a01b03909116815260200160405180910390f35b6000546001600160a01b031661006e565b6100596100a936600461044e565b61025c565b6000546001600160a01b031633146100e15760405162461bcd60e51b81526004016100d890610470565b60405180910390fd5b600080546040516001600160a01b03909116907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0908390a3600080546001600160a01b0319169055565b600080546001600160a01b031633146101565760405162461bcd60e51b81526004016100d890610470565b60008b8b8b8b8b8b8b8b8b8b60405161016e90610346565b6101819a999897969594939291906104a5565b604051809103906000f08015801561019d573d6000803e3d6000fd5b5060405163f2fde38b60e01b81523360048201529091506001600160a01b0382169063f2fde38b90602401600060405180830381600087803b1580156101e257600080fd5b505af11580156101f6573d6000803e3d6000fd5b50505050806001600160a01b03167f8d7dc276cb80789d9293dbc1e29d9fa53957db3e1d2d5a28c2609ab490a769268d8d8d8d8d8d8d8d8d8d6040516102459a999897969594939291906104a5565b60405180910390a29b9a5050505050505050505050565b6000546001600160a01b031633146102865760405162461bcd60e51b81526004016100d890610470565b6001600160a01b0381166102eb5760405162461bcd60e51b815260206004820152602660248201527f4f776e61626c653a206e6577206f776e657220697320746865207a65726f206160448201526564647265737360d01b60648201526084016100d8565b600080546040516001600160a01b03808516939216917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e091a3600080546001600160a01b0319166001600160a01b0392909216919091179055565b6124618061051183390190565b80356001600160a01b038116811461036a57600080fd5b919050565b803567ffffffffffffffff8116811461036a57600080fd5b803563ffffffff8116811461036a57600080fd5b6000806000806000806000806000806101408b8d0312156103bb57600080fd5b6103c48b610353565b99506103d260208c01610353565b98506103e060408c01610353565b97506103ee60608c0161036f565b96506103fc60808c0161036f565b955061040a60a08c01610387565b945061041860c08c01610387565b935060e08b0135925061042e6101008c01610387565b915061043d6101208c01610387565b90509295989b9194979a5092959850565b60006020828403121561046057600080fd5b61046982610353565b9392505050565b6020808252818101527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572604082015260600190565b6001600160a01b039a8b168152988a1660208a015296909816604088015267ffffffffffffffff948516606088015292909316608086015263ffffffff90811660a086015291821660c085015260e0840152928316610100830152909116610120820152610140019056fe6101806040523480156200001257600080fd5b5060405162002461380380620024618339810160408190526200003591620001c0565b600080546001600160a01b031916339081178255604051899289928992899282917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0908290a3506001600160401b039384166080529190921660015563ffffffff91821660a052811660c0523361016052811660e0526001600160a01b03898116610100528816610140526040518a90309085908590620000d69062000168565b6001600160a01b039485168152939092166020840152604083015263ffffffff166060820152608001604051809103906000f0801580156200011c573d6000803e3d6000fd5b506001600160a01b03166101205250506006805460ff1916600117905550506004805463ffffffff4316600160a01b0263ffffffff60a01b199091161790555062000286945050505050565b610b24806200193d83390190565b80516001600160a01b03811681146200018e57600080fd5b919050565b80516001600160401b03811681146200018e57600080fd5b805163ffffffff811681146200018e57600080fd5b6000806000806000806000806000806101408b8d031215620001e157600080fd5b620001ec8b62000176565b9950620001fc60208c0162000176565b98506200020c60408c0162000176565b97506200021c60608c0162000193565b96506200022c60808c0162000193565b95506200023c60a08c01620001ab565b94506200024c60c08c01620001ab565b935060e08b01519250620002646101008c01620001ab565b9150620002756101208c01620001ab565b90509295989b9194979a5092959850565b60805160a05160c05160e0516101005161012051610140516101605161160462000339600039600081816103bb0152610d6301526000818161037901528181610d8e0152610e5f0152600081816102090152818161031b01528181610457015261091b01526000818161024801528181610571015281816107aa0152610f140152600081816102a10152818161065f015261081f0152600061123e01526000611216015260006111e201526116046000f3fe608060405234801561001057600080fd5b50600436106101375760003560e01c80637aad19ff116100b857806392b228b31161007c57806392b228b314610374578063a5a6cd0b1461039b578063affbbda9146103ae578063c45a0155146103b6578063f2fde38b146103dd578063faab2c90146103f057600080fd5b80637aad19ff146102f557806385425f4f1461030a5780638936b63b1461033d5780638da5cb5b146103505780638e6a81291461036157600080fd5b806350868956116100ff578063508689561461026a57806352e031e51461028b57806354fd4d501461029c57806367faa2b6146102d8578063715018a6146102ed57600080fd5b806301cc7c4d1461013c57806302fb0c5e146101dd5780630c08bf88146101fa5780630f4ef8a6146102045780634cf088d914610243575b600080fd5b6101a761014a366004611340565b60408051606080820183526000808352602080840182905292840181905293845260058252928290208251938401835280546001600160a01b0381168552600160a01b900463ffffffff1691840191909152600101549082015290565b6040805182516001600160a01b0316815260208084015163ffffffff169082015291810151908201526060015b60405180910390f35b6006546101ea9060ff1681565b60405190151581526020016101d4565b610202610422565b005b61022b7f000000000000000000000000000000000000000000000000000000000000000081565b6040516001600160a01b0390911681526020016101d4565b61022b7f000000000000000000000000000000000000000000000000000000000000000081565b61027d610278366004611371565b610530565b6040519081526020016101d4565b6004546001600160a01b031661022b565b6102c37f000000000000000000000000000000000000000000000000000000000000000081565b60405163ffffffff90911681526020016101d4565b600454600160a01b900463ffffffff1661027d565b6102026105e7565b600454600160c01b900463ffffffff1661027d565b61022b610318366004611340565b507f000000000000000000000000000000000000000000000000000000000000000090565b6101ea61034b3660046113ae565b61065b565b6000546001600160a01b031661022b565b6101ea61036f366004611371565b610769565b61022b7f000000000000000000000000000000000000000000000000000000000000000081565b6101ea6103a9366004611340565b61081b565b61027d6109a5565b61022b7f000000000000000000000000000000000000000000000000000000000000000081565b6102026103eb366004611371565b6109c6565b6104036103fe366004611431565b610ab0565b6040805192151583526001600160a01b039091166020830152016101d4565b6000546001600160a01b031633146104555760405162461bcd60e51b815260040161044c90611464565b60405180910390fd5b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316638aec85426040518163ffffffff1660e01b8152600401602060405180830381865afa1580156104b3573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906104d79190611499565b156105245760405162461bcd60e51b815260206004820152601f60248201527f5265776172644d616e61676572207374696c6c20686f6c64732066756e647300604482015260640161044c565b6006805460ff19169055565b60015460048054604051633a02a42d60e01b81526001600160a01b03808616938201939093526000936105e1939092600160a01b900463ffffffff169186917f00000000000000000000000000000000000000000000000000000000000000001690633a02a42d90602401602060405180830381865afa1580156105b8573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906105dc9190611499565b610ca9565b92915050565b6000546001600160a01b031633146106115760405162461bcd60e51b815260040161044c90611464565b600080546040516001600160a01b03909116907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0908390a3600080546001600160a01b0319169055565b60007f000000000000000000000000000000000000000000000000000000000000000063ffffffff166002146106cb5760405162461bcd60e51b8152602060048201526015602482015274383937ba37b1b7b6103430b9903a37903132902b1960591b604482015260640161044c565b60006106d5610d46565b9050336001600160a01b0316816001600160a01b03167f940e173156be8ef613108cfeccd9bce20976d05ae59ee16c3b6e1ff74cef935f6107458863ffffffff1685898960405160200161072a9291906114b2565b60405160208183030381529060405280519060200120610fad565b8787604051610756939291906114c2565b60405180910390a3506001949350505050565b60015460048054604051633a02a42d60e01b81526001600160a01b03808616938201939093526000936105e1939092600160a01b900463ffffffff169186917f00000000000000000000000000000000000000000000000000000000000000001690633a02a42d906024015b602060405180830381865afa1580156107f2573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906108169190611499565b6110b3565b60007f000000000000000000000000000000000000000000000000000000000000000063ffffffff1660011461088b5760405162461bcd60e51b815260206004820152601560248201527470726f746f636f6c2068617320746f20626520563160581b604482015260640161044c565b6000610895610d46565b60045460408051600160c01b90920463ffffffff168083526020830182905260009183019190915291925033906001600160a01b038416907f940e173156be8ef613108cfeccd9bce20976d05ae59ee16c3b6e1ff74cef935f9060600160405180910390a36040516303a7b07f60e61b815263ffffffff821660048201523360248201527f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03169063e9ec1fc090604401600060405180830381600087803b15801561096757600080fd5b505af115801561097b573d6000803e3d6000fd5b5050505061099b828260016109909190611514565b63ffffffff16611153565b5060019392505050565b6004546000906109c190600160a01b900463ffffffff166111bc565b905090565b6000546001600160a01b031633146109f05760405162461bcd60e51b815260040161044c90611464565b6001600160a01b038116610a555760405162461bcd60e51b815260206004820152602660248201527f4f776e61626c653a206e6577206f776e657220697320746865207a65726f206160448201526564647265737360d01b606482015260840161044c565b600080546040516001600160a01b03808516939216917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e091a3600080546001600160a01b0319166001600160a01b0392909216919091179055565b6040516301b2a42d60e01b81526002600482015263ffffffff8316602482015260009081908190737a24cD1c71Ef908a904f3978F2da8bfbA2213247906301b2a42d90604401602060405180830381865af4158015610b13573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610b379190611499565b6040516334a4425b60e11b8152600260048201529091506000908190737a24cD1c71Ef908a904f3978F2da8bfbA22132479063694884b6906024016040805180830381865af4158015610b8e573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610bb2919061153c565b6040516375e6dc3960e11b8152600260048201526024810183905260448101869052919350915063ffffffff881690737a24cD1c71Ef908a904f3978F2da8bfbA22132479063ebcdb87290606401602060405180830381865af4158015610c1d573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610c419190611499565b14610c555760008094509450505050610ca2565b63ffffffff8616610c668483611560565b10610c97575050505063ffffffff8316600090815260056020526040902054600191506001600160a01b0316610ca2565b600080945094505050505b9250929050565b60405163130e5bbd60e11b815260048101859052602481018490526001600160a01b03831660448201526064810182905260009073168c31E8A09AB01457Ac3c7dfab034599C57eb869063261cb77a90608401602060405180830381865af4158015610d19573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610d3d9190611499565b95945050505050565b6040516332f256cf60e11b81523360048201526001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000811660248301526000917f0000000000000000000000000000000000000000000000000000000000000000909116906365e4ad9e90604401602060405180830381865afa158015610dd7573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610dfb9190611577565b610e475760405162461bcd60e51b815260206004820152601c60248201527f6d73672e73656e646572206973206e6f7420617574686f72697a656400000000604482015260640161044c565b60405163fa54416160e01b81523360048201526000907f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03169063fa54416190602401602060405180830381865afa158015610eae573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610ed29190611599565b60048054600154604051633a02a42d60e01b81526001600160a01b0380861694820194909452939450600160a01b90910463ffffffff1692610f4392849186917f00000000000000000000000000000000000000000000000000000000000000001690633a02a42d906024016107d5565b610f8f5760405162461bcd60e51b815260206004820152601c60248201527f5573657220636f756c646e742070726f64756365206120626c6f636b00000000604482015260640161044c565b610fa7610fa263ffffffff831643611560565b6111c7565b50919050565b604051634e9319b960e11b815260026004820152602481018490526000908190737a24cD1c71Ef908a904f3978F2da8bfbA221324790639d26337290604401602060405180830381865af4158015611009573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061102d9190611499565b604080516060810182526001600160a01b03808816825263ffffffff43811660208085019182528486018a815260008881526005909252959020935184549151909216600160a01b026001600160c01b0319909116919092161717815590516001918201559091506110ab9085906110a69084906115b6565b611153565b949350505050565b60405163130e5bbd60e11b815260048101859052602481018490526001600160a01b03831660448201526064810182905260009073168c31E8A09AB01457Ac3c7dfab034599C57eb869063261cb77a90608401602060405180830381865af4158015611123573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906111479190611499565b43101595945050505050565b604080516060810182526001600160a01b0390931680845263ffffffff4381166020860181905293169390910183905260048054600160c01b90940263ffffffff60c01b19600160a01b9094026001600160c01b03199095169092179390931791909116179055565b60006105e182611305565b600154604051635b01605f60e11b815267ffffffffffffffff7f0000000000000000000000000000000000000000000000000000000000000000166004820152602481019190915263ffffffff7f0000000000000000000000000000000000000000000000000000000000000000811660448301527f00000000000000000000000000000000000000000000000000000000000000001660648201526084810182905273f055A2142AE38217A7Bc9dB16EaE7debd4A725Fb9063b602c0be9060a401602060405180830381865af41580156112a6573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906112ca9190611499565b60018190556040519081527f5a790c48cbebdceff3f1fcd445afd12d57302b7196738d61c60dcd491bf3efba9060200160405180910390a150565b60006028820143811061131b5750600092915050565b43819003610100810660000361133657506101009392505050565b60ff169392505050565b60006020828403121561135257600080fd5b5035919050565b6001600160a01b038116811461136e57600080fd5b50565b60006020828403121561138357600080fd5b813561138e81611359565b9392505050565b803563ffffffff811681146113a957600080fd5b919050565b6000806000604084860312156113c357600080fd5b6113cc84611395565b9250602084013567ffffffffffffffff808211156113e957600080fd5b818601915086601f8301126113fd57600080fd5b81358181111561140c57600080fd5b87602082850101111561141e57600080fd5b6020830194508093505050509250925092565b6000806040838503121561144457600080fd5b61144d83611395565b915061145b60208401611395565b90509250929050565b6020808252818101527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572604082015260600190565b6000602082840312156114ab57600080fd5b5051919050565b8183823760009101908152919050565b63ffffffff8416815260406020820152816040820152818360608301376000818301606090810191909152601f909201601f1916010192915050565b634e487b7160e01b600052601160045260246000fd5b600063ffffffff808316818516808303821115611533576115336114fe565b01949350505050565b6000806040838503121561154f57600080fd5b505080516020909101519092909150565b600082821015611572576115726114fe565b500390565b60006020828403121561158957600080fd5b8151801515811461138e57600080fd5b6000602082840312156115ab57600080fd5b815161138e81611359565b600082198211156115c9576115c96114fe565b50019056fea2646970667358221220529f9b0f7988e73abfe1365db5cbbf0a0928386f0a4df04dbd8a7c62d4ea379664736f6c634300080e003361010060405234801561001157600080fd5b50604051610b24380380610b2483398101604081905261003091610075565b6001600160a01b0393841660c0529190921660e05260809190915263ffffffff1660a0526100cd565b80516001600160a01b038116811461007057600080fd5b919050565b6000806000806080858703121561008b57600080fd5b61009485610059565b93506100a260208601610059565b925060408501519150606085015163ffffffff811681146100c257600080fd5b939692955090935050565b60805160a05160c05160e0516109fc6101286000396000818160c7015281816102bc015261058b0152600081816104600152818161062b01526106f801526000610333015260008181610777015261079e01526109fc6000f3fe608060405234801561001057600080fd5b50600436106100625760003560e01c806309b290681461006757806312065fe01461008f57806385ac2fa9146100a55780638aec8542146100ba578063c56551b6146100c2578063e9ec1fc014610101575b600080fd5b61007a61007536600461085a565b610114565b60405190151581526020015b60405180910390f35b61009761019d565b604051908152602001610086565b6100b86100b336600461087c565b6101ac565b005b610097610576565b6100e97f000000000000000000000000000000000000000000000000000000000000000081565b6040516001600160a01b039091168152602001610086565b6100b861010f366004610909565b610580565b6040516303fbaf7360e01b815260006004820181905263ffffffff831660248301529073CC075E3e753f5a269781e512A925f9D5059B41D2906303fbaf7390604401602060405180830381865af4158015610173573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101979190610950565b92915050565b60006101a76106e0565b905090565b60005b818110156105715773CC075E3e753f5a269781e512A925f9D5059B41D26303fbaf7360008585858181106101e5576101e561096b565b90506020020160208101906101fa919061085a565b6040516001600160e01b031960e085901b168152600481019290925263ffffffff166024820152604401602060405180830381865af4158015610241573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102659190610950565b156102b75760405162461bcd60e51b815260206004820152601b60248201527f54686520626c6f636b20686173206265656e207265776172646564000000000060448201526064015b60405180910390fd5b6000807f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663faab2c908686868181106102fb576102fb61096b565b9050602002016020810190610310919061085a565b60405160e083901b6001600160e01b031916815263ffffffff91821660048201527f000000000000000000000000000000000000000000000000000000000000000090911660248201526044016040805180830381865afa158015610379573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061039d9190610981565b91509150816103de5760405162461bcd60e51b815260206004820152600d60248201526c496e76616c696420626c6f636b60981b60448201526064016102ae565b60006103e861076b565b90506000811161043a5760405162461bcd60e51b815260206004820152601a60248201527f5265776172644d616e6167657220686173206e6f2066756e647300000000000060448201526064016102ae565b60405163a9059cbb60e01b81526001600160a01b038381166004830152602482018390527f0000000000000000000000000000000000000000000000000000000000000000169063a9059cbb906044016020604051808303816000875af11580156104a9573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906104cd9190610950565b506104fd8686868181106104e3576104e361096b565b90506020020160208101906104f8919061085a565b6107c8565b85858581811061050f5761050f61096b565b9050602002016020810190610524919061085a565b63ffffffff167fc03e4bb56a67f4e04f08102325c70cf9e42f888a19d6d634bbee5f2a3a0b73d98260405161055b91815260200190565b60405180910390a28360010193505050506101af565b505050565b60006101a761076b565b336001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016146105f85760405162461bcd60e51b815260206004820152601e60248201527f4f6e6c792074686520706f7320636f6e74726163742063616e2063616c6c000060448201526064016102ae565b600061060261076b565b60405163a9059cbb60e01b81526001600160a01b038481166004830152602482018390529192507f00000000000000000000000000000000000000000000000000000000000000009091169063a9059cbb906044016020604051808303816000875af1158015610676573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061069a9190610950565b508263ffffffff167fc03e4bb56a67f4e04f08102325c70cf9e42f888a19d6d634bbee5f2a3a0b73d9826040516106d391815260200190565b60405180910390a2505050565b6040516370a0823160e01b81523060048201526000907f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316906370a0823190602401602060405180830381865afa158015610747573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101a791906109ad565b60006107756106e0565b7f0000000000000000000000000000000000000000000000000000000000000000116107c057507f000000000000000000000000000000000000000000000000000000000000000090565b6101a76106e0565b6040516306449da160e41b81526000600482015263ffffffff821660248201526001604482015273CC075E3e753f5a269781e512A925f9D5059B41D290636449da109060640160006040518083038186803b15801561082657600080fd5b505af415801561083a573d6000803e3d6000fd5b5050505050565b803563ffffffff8116811461085557600080fd5b919050565b60006020828403121561086c57600080fd5b61087582610841565b9392505050565b6000806020838503121561088f57600080fd5b823567ffffffffffffffff808211156108a757600080fd5b818501915085601f8301126108bb57600080fd5b8135818111156108ca57600080fd5b8660208260051b85010111156108df57600080fd5b60209290920196919550909350505050565b6001600160a01b038116811461090657600080fd5b50565b6000806040838503121561091c57600080fd5b61092583610841565b91506020830135610935816108f1565b809150509250929050565b8051801515811461085557600080fd5b60006020828403121561096257600080fd5b61087582610940565b634e487b7160e01b600052603260045260246000fd5b6000806040838503121561099457600080fd5b61099d83610940565b91506020830151610935816108f1565b6000602082840312156109bf57600080fd5b505191905056fea2646970667358221220e63a7530a052412b3327cb84e6c058505f7358cb78ce34fdab0b82dedc4017cc64736f6c634300080e0033a26469706673582212203b48bb4339a89e7cd220710e5bbaf536d0435d22900dcaf3eb597b76d091b93a64736f6c634300080e0033",
  "deployedBytecode": "0x608060405234801561001057600080fd5b506004361061004c5760003560e01c8063715018a6146100515780637d982ea61461005b5780638da5cb5b1461008a578063f2fde38b1461009b575b600080fd5b6100596100ae565b005b61006e61006936600461039b565b61012b565b6040516001600160a01b03909116815260200160405180910390f35b6000546001600160a01b031661006e565b6100596100a936600461044e565b61025c565b6000546001600160a01b031633146100e15760405162461bcd60e51b81526004016100d890610470565b60405180910390fd5b600080546040516001600160a01b03909116907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0908390a3600080546001600160a01b0319169055565b600080546001600160a01b031633146101565760405162461bcd60e51b81526004016100d890610470565b60008b8b8b8b8b8b8b8b8b8b60405161016e90610346565b6101819a999897969594939291906104a5565b604051809103906000f08015801561019d573d6000803e3d6000fd5b5060405163f2fde38b60e01b81523360048201529091506001600160a01b0382169063f2fde38b90602401600060405180830381600087803b1580156101e257600080fd5b505af11580156101f6573d6000803e3d6000fd5b50505050806001600160a01b03167f8d7dc276cb80789d9293dbc1e29d9fa53957db3e1d2d5a28c2609ab490a769268d8d8d8d8d8d8d8d8d8d6040516102459a999897969594939291906104a5565b60405180910390a29b9a5050505050505050505050565b6000546001600160a01b031633146102865760405162461bcd60e51b81526004016100d890610470565b6001600160a01b0381166102eb5760405162461bcd60e51b815260206004820152602660248201527f4f776e61626c653a206e6577206f776e657220697320746865207a65726f206160448201526564647265737360d01b60648201526084016100d8565b600080546040516001600160a01b03808516939216917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e091a3600080546001600160a01b0319166001600160a01b0392909216919091179055565b6124618061051183390190565b80356001600160a01b038116811461036a57600080fd5b919050565b803567ffffffffffffffff8116811461036a57600080fd5b803563ffffffff8116811461036a57600080fd5b6000806000806000806000806000806101408b8d0312156103bb57600080fd5b6103c48b610353565b99506103d260208c01610353565b98506103e060408c01610353565b97506103ee60608c0161036f565b96506103fc60808c0161036f565b955061040a60a08c01610387565b945061041860c08c01610387565b935060e08b0135925061042e6101008c01610387565b915061043d6101208c01610387565b90509295989b9194979a5092959850565b60006020828403121561046057600080fd5b61046982610353565b9392505050565b6020808252818101527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572604082015260600190565b6001600160a01b039a8b168152988a1660208a015296909816604088015267ffffffffffffffff948516606088015292909316608086015263ffffffff90811660a086015291821660c085015260e0840152928316610100830152909116610120820152610140019056fe6101806040523480156200001257600080fd5b5060405162002461380380620024618339810160408190526200003591620001c0565b600080546001600160a01b031916339081178255604051899289928992899282917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0908290a3506001600160401b039384166080529190921660015563ffffffff91821660a052811660c0523361016052811660e0526001600160a01b03898116610100528816610140526040518a90309085908590620000d69062000168565b6001600160a01b039485168152939092166020840152604083015263ffffffff166060820152608001604051809103906000f0801580156200011c573d6000803e3d6000fd5b506001600160a01b03166101205250506006805460ff1916600117905550506004805463ffffffff4316600160a01b0263ffffffff60a01b199091161790555062000286945050505050565b610b24806200193d83390190565b80516001600160a01b03811681146200018e57600080fd5b919050565b80516001600160401b03811681146200018e57600080fd5b805163ffffffff811681146200018e57600080fd5b6000806000806000806000806000806101408b8d031215620001e157600080fd5b620001ec8b62000176565b9950620001fc60208c0162000176565b98506200020c60408c0162000176565b97506200021c60608c0162000193565b96506200022c60808c0162000193565b95506200023c60a08c01620001ab565b94506200024c60c08c01620001ab565b935060e08b01519250620002646101008c01620001ab565b9150620002756101208c01620001ab565b90509295989b9194979a5092959850565b60805160a05160c05160e0516101005161012051610140516101605161160462000339600039600081816103bb0152610d6301526000818161037901528181610d8e0152610e5f0152600081816102090152818161031b01528181610457015261091b01526000818161024801528181610571015281816107aa0152610f140152600081816102a10152818161065f015261081f0152600061123e01526000611216015260006111e201526116046000f3fe608060405234801561001057600080fd5b50600436106101375760003560e01c80637aad19ff116100b857806392b228b31161007c57806392b228b314610374578063a5a6cd0b1461039b578063affbbda9146103ae578063c45a0155146103b6578063f2fde38b146103dd578063faab2c90146103f057600080fd5b80637aad19ff146102f557806385425f4f1461030a5780638936b63b1461033d5780638da5cb5b146103505780638e6a81291461036157600080fd5b806350868956116100ff578063508689561461026a57806352e031e51461028b57806354fd4d501461029c57806367faa2b6146102d8578063715018a6146102ed57600080fd5b806301cc7c4d1461013c57806302fb0c5e146101dd5780630c08bf88146101fa5780630f4ef8a6146102045780634cf088d914610243575b600080fd5b6101a761014a366004611340565b60408051606080820183526000808352602080840182905292840181905293845260058252928290208251938401835280546001600160a01b0381168552600160a01b900463ffffffff1691840191909152600101549082015290565b6040805182516001600160a01b0316815260208084015163ffffffff169082015291810151908201526060015b60405180910390f35b6006546101ea9060ff1681565b60405190151581526020016101d4565b610202610422565b005b61022b7f000000000000000000000000000000000000000000000000000000000000000081565b6040516001600160a01b0390911681526020016101d4565b61022b7f000000000000000000000000000000000000000000000000000000000000000081565b61027d610278366004611371565b610530565b6040519081526020016101d4565b6004546001600160a01b031661022b565b6102c37f000000000000000000000000000000000000000000000000000000000000000081565b60405163ffffffff90911681526020016101d4565b600454600160a01b900463ffffffff1661027d565b6102026105e7565b600454600160c01b900463ffffffff1661027d565b61022b610318366004611340565b507f000000000000000000000000000000000000000000000000000000000000000090565b6101ea61034b3660046113ae565b61065b565b6000546001600160a01b031661022b565b6101ea61036f366004611371565b610769565b61022b7f000000000000000000000000000000000000000000000000000000000000000081565b6101ea6103a9366004611340565b61081b565b61027d6109a5565b61022b7f000000000000000000000000000000000000000000000000000000000000000081565b6102026103eb366004611371565b6109c6565b6104036103fe366004611431565b610ab0565b6040805192151583526001600160a01b039091166020830152016101d4565b6000546001600160a01b031633146104555760405162461bcd60e51b815260040161044c90611464565b60405180910390fd5b7f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316638aec85426040518163ffffffff1660e01b8152600401602060405180830381865afa1580156104b3573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906104d79190611499565b156105245760405162461bcd60e51b815260206004820152601f60248201527f5265776172644d616e61676572207374696c6c20686f6c64732066756e647300604482015260640161044c565b6006805460ff19169055565b60015460048054604051633a02a42d60e01b81526001600160a01b03808616938201939093526000936105e1939092600160a01b900463ffffffff169186917f00000000000000000000000000000000000000000000000000000000000000001690633a02a42d90602401602060405180830381865afa1580156105b8573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906105dc9190611499565b610ca9565b92915050565b6000546001600160a01b031633146106115760405162461bcd60e51b815260040161044c90611464565b600080546040516001600160a01b03909116907f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e0908390a3600080546001600160a01b0319169055565b60007f000000000000000000000000000000000000000000000000000000000000000063ffffffff166002146106cb5760405162461bcd60e51b8152602060048201526015602482015274383937ba37b1b7b6103430b9903a37903132902b1960591b604482015260640161044c565b60006106d5610d46565b9050336001600160a01b0316816001600160a01b03167f940e173156be8ef613108cfeccd9bce20976d05ae59ee16c3b6e1ff74cef935f6107458863ffffffff1685898960405160200161072a9291906114b2565b60405160208183030381529060405280519060200120610fad565b8787604051610756939291906114c2565b60405180910390a3506001949350505050565b60015460048054604051633a02a42d60e01b81526001600160a01b03808616938201939093526000936105e1939092600160a01b900463ffffffff169186917f00000000000000000000000000000000000000000000000000000000000000001690633a02a42d906024015b602060405180830381865afa1580156107f2573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906108169190611499565b6110b3565b60007f000000000000000000000000000000000000000000000000000000000000000063ffffffff1660011461088b5760405162461bcd60e51b815260206004820152601560248201527470726f746f636f6c2068617320746f20626520563160581b604482015260640161044c565b6000610895610d46565b60045460408051600160c01b90920463ffffffff168083526020830182905260009183019190915291925033906001600160a01b038416907f940e173156be8ef613108cfeccd9bce20976d05ae59ee16c3b6e1ff74cef935f9060600160405180910390a36040516303a7b07f60e61b815263ffffffff821660048201523360248201527f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03169063e9ec1fc090604401600060405180830381600087803b15801561096757600080fd5b505af115801561097b573d6000803e3d6000fd5b5050505061099b828260016109909190611514565b63ffffffff16611153565b5060019392505050565b6004546000906109c190600160a01b900463ffffffff166111bc565b905090565b6000546001600160a01b031633146109f05760405162461bcd60e51b815260040161044c90611464565b6001600160a01b038116610a555760405162461bcd60e51b815260206004820152602660248201527f4f776e61626c653a206e6577206f776e657220697320746865207a65726f206160448201526564647265737360d01b606482015260840161044c565b600080546040516001600160a01b03808516939216917f8be0079c531659141344cd1fd0a4f28419497f9722a3daafe3b4186f6b6457e091a3600080546001600160a01b0319166001600160a01b0392909216919091179055565b6040516301b2a42d60e01b81526002600482015263ffffffff831660248201526000908190819073__$e1e819b4790721726f0448d116c4c7b48f$__906301b2a42d90604401602060405180830381865af4158015610b13573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610b379190611499565b6040516334a4425b60e11b815260026004820152909150600090819073__$e1e819b4790721726f0448d116c4c7b48f$__9063694884b6906024016040805180830381865af4158015610b8e573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610bb2919061153c565b6040516375e6dc3960e11b8152600260048201526024810183905260448101869052919350915063ffffffff88169073__$e1e819b4790721726f0448d116c4c7b48f$__9063ebcdb87290606401602060405180830381865af4158015610c1d573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610c419190611499565b14610c555760008094509450505050610ca2565b63ffffffff8616610c668483611560565b10610c97575050505063ffffffff8316600090815260056020526040902054600191506001600160a01b0316610ca2565b600080945094505050505b9250929050565b60405163130e5bbd60e11b815260048101859052602481018490526001600160a01b03831660448201526064810182905260009073__$f5ef60794fd47af037390b6d5a162c7d54$__9063261cb77a90608401602060405180830381865af4158015610d19573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610d3d9190611499565b95945050505050565b6040516332f256cf60e11b81523360048201526001600160a01b037f0000000000000000000000000000000000000000000000000000000000000000811660248301526000917f0000000000000000000000000000000000000000000000000000000000000000909116906365e4ad9e90604401602060405180830381865afa158015610dd7573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610dfb9190611577565b610e475760405162461bcd60e51b815260206004820152601c60248201527f6d73672e73656e646572206973206e6f7420617574686f72697a656400000000604482015260640161044c565b60405163fa54416160e01b81523360048201526000907f00000000000000000000000000000000000000000000000000000000000000006001600160a01b03169063fa54416190602401602060405180830381865afa158015610eae573d6000803e3d6000fd5b505050506040513d601f19601f82011682018060405250810190610ed29190611599565b60048054600154604051633a02a42d60e01b81526001600160a01b0380861694820194909452939450600160a01b90910463ffffffff1692610f4392849186917f00000000000000000000000000000000000000000000000000000000000000001690633a02a42d906024016107d5565b610f8f5760405162461bcd60e51b815260206004820152601c60248201527f5573657220636f756c646e742070726f64756365206120626c6f636b00000000604482015260640161044c565b610fa7610fa263ffffffff831643611560565b6111c7565b50919050565b604051634e9319b960e11b81526002600482015260248101849052600090819073__$e1e819b4790721726f0448d116c4c7b48f$__90639d26337290604401602060405180830381865af4158015611009573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061102d9190611499565b604080516060810182526001600160a01b03808816825263ffffffff43811660208085019182528486018a815260008881526005909252959020935184549151909216600160a01b026001600160c01b0319909116919092161717815590516001918201559091506110ab9085906110a69084906115b6565b611153565b949350505050565b60405163130e5bbd60e11b815260048101859052602481018490526001600160a01b03831660448201526064810182905260009073__$f5ef60794fd47af037390b6d5a162c7d54$__9063261cb77a90608401602060405180830381865af4158015611123573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906111479190611499565b43101595945050505050565b604080516060810182526001600160a01b0390931680845263ffffffff4381166020860181905293169390910183905260048054600160c01b90940263ffffffff60c01b19600160a01b9094026001600160c01b03199095169092179390931791909116179055565b60006105e182611305565b600154604051635b01605f60e11b815267ffffffffffffffff7f0000000000000000000000000000000000000000000000000000000000000000166004820152602481019190915263ffffffff7f0000000000000000000000000000000000000000000000000000000000000000811660448301527f00000000000000000000000000000000000000000000000000000000000000001660648201526084810182905273__$585bd6ccc1dd1141eeb13fab52b3a8b211$__9063b602c0be9060a401602060405180830381865af41580156112a6573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906112ca9190611499565b60018190556040519081527f5a790c48cbebdceff3f1fcd445afd12d57302b7196738d61c60dcd491bf3efba9060200160405180910390a150565b60006028820143811061131b5750600092915050565b43819003610100810660000361133657506101009392505050565b60ff169392505050565b60006020828403121561135257600080fd5b5035919050565b6001600160a01b038116811461136e57600080fd5b50565b60006020828403121561138357600080fd5b813561138e81611359565b9392505050565b803563ffffffff811681146113a957600080fd5b919050565b6000806000604084860312156113c357600080fd5b6113cc84611395565b9250602084013567ffffffffffffffff808211156113e957600080fd5b818601915086601f8301126113fd57600080fd5b81358181111561140c57600080fd5b87602082850101111561141e57600080fd5b6020830194508093505050509250925092565b6000806040838503121561144457600080fd5b61144d83611395565b915061145b60208401611395565b90509250929050565b6020808252818101527f4f776e61626c653a2063616c6c6572206973206e6f7420746865206f776e6572604082015260600190565b6000602082840312156114ab57600080fd5b5051919050565b8183823760009101908152919050565b63ffffffff8416815260406020820152816040820152818360608301376000818301606090810191909152601f909201601f1916010192915050565b634e487b7160e01b600052601160045260246000fd5b600063ffffffff808316818516808303821115611533576115336114fe565b01949350505050565b6000806040838503121561154f57600080fd5b505080516020909101519092909150565b600082821015611572576115726114fe565b500390565b60006020828403121561158957600080fd5b8151801515811461138e57600080fd5b6000602082840312156115ab57600080fd5b815161138e81611359565b600082198211156115c9576115c96114fe565b50019056fea2646970667358221220529f9b0f7988e73abfe1365db5cbbf0a0928386f0a4df04dbd8a7c62d4ea379664736f6c634300080e003361010060405234801561001157600080fd5b50604051610b24380380610b2483398101604081905261003091610075565b6001600160a01b0393841660c0529190921660e05260809190915263ffffffff1660a0526100cd565b80516001600160a01b038116811461007057600080fd5b919050565b6000806000806080858703121561008b57600080fd5b61009485610059565b93506100a260208601610059565b925060408501519150606085015163ffffffff811681146100c257600080fd5b939692955090935050565b60805160a05160c05160e0516109fc6101286000396000818160c7015281816102bc015261058b0152600081816104600152818161062b01526106f801526000610333015260008181610777015261079e01526109fc6000f3fe608060405234801561001057600080fd5b50600436106100625760003560e01c806309b290681461006757806312065fe01461008f57806385ac2fa9146100a55780638aec8542146100ba578063c56551b6146100c2578063e9ec1fc014610101575b600080fd5b61007a61007536600461085a565b610114565b60405190151581526020015b60405180910390f35b61009761019d565b604051908152602001610086565b6100b86100b336600461087c565b6101ac565b005b610097610576565b6100e97f000000000000000000000000000000000000000000000000000000000000000081565b6040516001600160a01b039091168152602001610086565b6100b861010f366004610909565b610580565b6040516303fbaf7360e01b815260006004820181905263ffffffff831660248301529073__$f57eb21c11c6dae369da3ca36f4f48eb77$__906303fbaf7390604401602060405180830381865af4158015610173573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101979190610950565b92915050565b60006101a76106e0565b905090565b60005b818110156105715773__$f57eb21c11c6dae369da3ca36f4f48eb77$__6303fbaf7360008585858181106101e5576101e561096b565b90506020020160208101906101fa919061085a565b6040516001600160e01b031960e085901b168152600481019290925263ffffffff166024820152604401602060405180830381865af4158015610241573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906102659190610950565b156102b75760405162461bcd60e51b815260206004820152601b60248201527f54686520626c6f636b20686173206265656e207265776172646564000000000060448201526064015b60405180910390fd5b6000807f00000000000000000000000000000000000000000000000000000000000000006001600160a01b031663faab2c908686868181106102fb576102fb61096b565b9050602002016020810190610310919061085a565b60405160e083901b6001600160e01b031916815263ffffffff91821660048201527f000000000000000000000000000000000000000000000000000000000000000090911660248201526044016040805180830381865afa158015610379573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061039d9190610981565b91509150816103de5760405162461bcd60e51b815260206004820152600d60248201526c496e76616c696420626c6f636b60981b60448201526064016102ae565b60006103e861076b565b90506000811161043a5760405162461bcd60e51b815260206004820152601a60248201527f5265776172644d616e6167657220686173206e6f2066756e647300000000000060448201526064016102ae565b60405163a9059cbb60e01b81526001600160a01b038381166004830152602482018390527f0000000000000000000000000000000000000000000000000000000000000000169063a9059cbb906044016020604051808303816000875af11580156104a9573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906104cd9190610950565b506104fd8686868181106104e3576104e361096b565b90506020020160208101906104f8919061085a565b6107c8565b85858581811061050f5761050f61096b565b9050602002016020810190610524919061085a565b63ffffffff167fc03e4bb56a67f4e04f08102325c70cf9e42f888a19d6d634bbee5f2a3a0b73d98260405161055b91815260200190565b60405180910390a28360010193505050506101af565b505050565b60006101a761076b565b336001600160a01b037f000000000000000000000000000000000000000000000000000000000000000016146105f85760405162461bcd60e51b815260206004820152601e60248201527f4f6e6c792074686520706f7320636f6e74726163742063616e2063616c6c000060448201526064016102ae565b600061060261076b565b60405163a9059cbb60e01b81526001600160a01b038481166004830152602482018390529192507f00000000000000000000000000000000000000000000000000000000000000009091169063a9059cbb906044016020604051808303816000875af1158015610676573d6000803e3d6000fd5b505050506040513d601f19601f8201168201806040525081019061069a9190610950565b508263ffffffff167fc03e4bb56a67f4e04f08102325c70cf9e42f888a19d6d634bbee5f2a3a0b73d9826040516106d391815260200190565b60405180910390a2505050565b6040516370a0823160e01b81523060048201526000907f00000000000000000000000000000000000000000000000000000000000000006001600160a01b0316906370a0823190602401602060405180830381865afa158015610747573d6000803e3d6000fd5b505050506040513d601f19601f820116820180604052508101906101a791906109ad565b60006107756106e0565b7f0000000000000000000000000000000000000000000000000000000000000000116107c057507f000000000000000000000000000000000000000000000000000000000000000090565b6101a76106e0565b6040516306449da160e41b81526000600482015263ffffffff821660248201526001604482015273__$f57eb21c11c6dae369da3ca36f4f48eb77$__90636449da109060640160006040518083038186803b15801561082657600080fd5b505af415801561083a573d6000803e3d6000fd5b5050505050565b803563ffffffff8116811461085557600080fd5b919050565b60006020828403121561086c57600080fd5b61087582610841565b9392505050565b6000806020838503121561088f57600080fd5b823567ffffffffffffffff808211156108a757600080fd5b818501915085601f8301126108bb57600080fd5b8135818111156108ca57600080fd5b8660208260051b85010111156108df57600080fd5b60209290920196919550909350505050565b6001600160a01b038116811461090657600080fd5b50565b6000806040838503121561091c57600080fd5b61092583610841565b91506020830135610935816108f1565b809150509250929050565b8051801515811461085557600080fd5b60006020828403121561096257600080fd5b61087582610940565b634e487b7160e01b600052603260045260246000fd5b6000806040838503121561099457600080fd5b61099d83610940565b91506020830151610935816108f1565b6000602082840312156109bf57600080fd5b505191905056fea2646970667358221220e63a7530a052412b3327cb84e6c058505f7358cb78ce34fdab0b82dedc4017cc64736f6c634300080e0033a26469706673582212203b48bb4339a89e7cd220710e5bbaf536d0435d22900dcaf3eb597b76d091b93a64736f6c634300080e0033",
  "libraries": {
    "Bitmask": "0xCC075E3e753f5a269781e512A925f9D5059B41D2",
    "Difficulty": "0xf055A2142AE38217A7Bc9dB16EaE7debd4A725Fb",
    "Eligibility": "0x168c31E8A09AB01457Ac3c7dfab034599C57eb86",
    "Tree": "0x7a24cD1c71Ef908a904f3978F2da8bfbA2213247"
  },
  "devdoc": {
    "kind": "dev",
    "methods": {
      "createNewChain(address,address,address,uint64,uint64,uint32,uint32,uint256,uint32,uint32)": {
        "params": {
          "_ctsiAddress": "address of token instance being used",
          "_difficultyAdjustmentParameter": "how quickly the difficulty gets updated",
          "_rewardDelay": "number of blocks confirmation before a reward can be claimed",
          "_rewardValue": "reward that reward manager contract pays",
          "_stakingAddress": "address of StakingInterface",
          "_targetInterval": "how often we want to elect a block producer",
          "_version": "protocol version of PoS",
          "_workerAuthAddress": "address of worker manager contract"
        }
      },
      "owner()": {
        "details": "Returns the address of the current owner."
      },
      "renounceOwnership()": {
        "details": "Leaves the contract without owner. It will not be possible to call `onlyOwner` functions anymore. Can only be called by the current owner. NOTE: Renouncing ownership will leave the contract without an owner, thereby removing any functionality that is only available to the owner."
      },
      "transferOwnership(address)": {
        "details": "Transfers ownership of the contract to a new account (`newOwner`). Can only be called by the current owner."
      }
    },
    "version": 1
  },
  "userdoc": {
    "events": {
      "NewChain(address,address,address,address,uint64,uint64,uint32,uint32,uint256,uint32,uint32)": {
        "notice": "Event emmited when a new chain is created"
      }
    },
    "kind": "user",
    "methods": {},
    "version": 1
  },
  "storageLayout": {
    "storage": [
      {
        "astId": 1928,
        "contract": "contracts/v2/PoSV2FactoryImpl.sol:PoSV2FactoryImpl",
        "label": "_owner",
        "offset": 0,
        "slot": "0",
        "type": "t_address"
      }
    ],
    "types": {
      "t_address": {
        "encoding": "inplace",
        "label": "address",
        "numberOfBytes": "20"
      }
    }
  }
}